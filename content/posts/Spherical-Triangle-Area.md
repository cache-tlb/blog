---
title: "球面三角形面积公式推导"
date: 2023-01-27T16:19:00+08:00
categories: ["数学"]
toc:
    enable: true
---
## 问题

单位球面上有三个大圆，构成一个球面三角形，顶点为 $A,B,C$，其内角分别是 $\alpha, \beta, \gamma$。求球面三角形的立体角（即面积）。

## 割补法

经典方法是通过发现待求的三角形与邻接的几个三角形的面积关系来求解。
设三个大圆相交的另外三个交点对应分别为 $A',B',C'$，如下图。
<div>
<center>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="240pt" height="240pt" viewBox="90 70 240 240" version="1.1">
<defs>
<g>
<symbol overflow="visible" id="glyph0-0">
<path style="stroke:none;" d=""/>
</symbol>
<symbol overflow="visible" id="glyph0-1">
<path style="stroke:none;" d="M 4.921875 -2.515625 C 4.921875 -4.078125 3.828125 -4.734375 3.09375 -4.734375 C 1.71875 -4.734375 0.234375 -3.140625 0.234375 -1.734375 C 0.234375 -0.8125 1 0.109375 2.03125 0.109375 C 2.65625 0.109375 3.484375 -0.171875 4.015625 -0.59375 C 4.078125 -0.359375 4.578125 0.109375 5.03125 0.109375 C 5.5625 0.109375 6.046875 -0.59375 6.046875 -0.75 C 6.046875 -0.828125 5.8125 -1.03125 5.75 -1.03125 C 5.6875 -1.03125 5.46875 -0.828125 5.4375 -0.75 C 5.265625 -0.265625 5.078125 -0.4375 5.0625 -0.4375 C 4.75 -0.4375 4.921875 -1.046875 4.921875 -1.28125 C 4.921875 -1.5 4.875 -1.40625 4.96875 -1.53125 C 5.90625 -2.703125 6.171875 -3.96875 6.171875 -3.984375 C 6.171875 -4 5.984375 -4.25 5.875 -4.25 C 5.78125 -4.25 5.609375 -4.046875 5.546875 -3.875 C 5.375 -3.234375 5.09375 -2.609375 4.625 -2.015625 L 4.921875 -1.890625 Z M 3.953125 -1.265625 C 3.078125 -0.5 2.4375 -0.4375 2.046875 -0.4375 C 1.453125 -0.4375 1.3125 -0.71875 1.3125 -1.359375 C 1.3125 -1.84375 1.53125 -2.8125 1.84375 -3.3125 C 2.3125 -4.046875 2.734375 -4.1875 3.078125 -4.1875 C 4.0625 -4.1875 3.890625 -3.046875 3.890625 -2.265625 C 3.890625 -1.890625 3.890625 -1.3125 3.890625 -1.21875 Z M 3.953125 -1.265625 "/>
</symbol>
<symbol overflow="visible" id="glyph0-2">
<path style="stroke:none;" d="M 5.90625 -5.828125 C 5.90625 -6.578125 5.1875 -7.359375 4.375 -7.359375 C 3.796875 -7.359375 3.390625 -7.15625 3.046875 -6.890625 C 2.5 -6.5 1.890625 -5.40625 1.703125 -4.65625 L 0.125 1.671875 C 0.109375 1.71875 0.34375 1.9375 0.421875 1.9375 C 0.5 1.9375 0.703125 1.75 0.703125 1.71875 L 1.40625 -1.03125 L 1.0625 -1.03125 C 1.25 -0.421875 1.859375 0.09375 2.59375 0.09375 C 3.3125 0.09375 4.1875 -0.296875 4.640625 -0.734375 C 5.109375 -1.203125 5.484375 -1.9375 5.484375 -2.6875 C 5.484375 -3.40625 5.0625 -4.03125 4.890625 -4.15625 C 5.28125 -4.390625 5.90625 -5.109375 5.90625 -5.828125 Z M 3.9375 -4.34375 C 3.8125 -4.296875 3.703125 -4.28125 3.453125 -4.28125 C 3.3125 -4.28125 3.234375 -4.21875 3.203125 -4.234375 C 3.203125 -4.25 3.40625 -4.0625 3.515625 -4.0625 C 3.71875 -4.0625 3.8125 -4.0625 3.9375 -4.015625 Z M 5 -6.0625 C 5 -5.359375 4.671875 -4.765625 4.25 -4.515625 C 4 -4.609375 3.8125 -4.625 3.515625 -4.625 C 3.296875 -4.625 2.5625 -4.46875 2.5625 -4.140625 C 2.546875 -3.859375 3.25 -3.734375 3.421875 -3.734375 C 3.796875 -3.734375 3.953125 -3.734375 4.203125 -3.84375 C 4.5 -3.546875 4.5 -3.34375 4.5 -2.890625 C 4.53125 -2.3125 4.34375 -1.6875 4.0625 -1.296875 C 3.671875 -0.75 3.125 -0.453125 2.5625 -0.453125 C 1.796875 -0.453125 1.59375 -0.859375 1.59375 -1.5625 C 1.59375 -1.671875 1.59375 -1.8125 1.640625 -2 L 2.28125 -4.53125 C 2.5 -5.390625 3.046875 -6.8125 4.25 -6.8125 C 4.828125 -6.8125 5 -6.65625 5 -6.0625 Z M 5 -6.0625 "/>
</symbol>
<symbol overflow="visible" id="glyph0-3">
<path style="stroke:none;" d="M 0.578125 -2.6875 C 0.96875 -3.84375 1.890625 -3.6875 2 -3.6875 C 3.5 -3.6875 3.421875 -2.109375 3.421875 -1.3125 C 3.421875 -0.703125 3.375 -0.53125 3.3125 -0.34375 C 3.09375 0.390625 2.796875 1.546875 2.796875 1.796875 C 2.796875 1.90625 3.015625 2.140625 3.09375 2.140625 C 3.234375 2.140625 3.484375 1.765625 3.59375 1.390625 C 3.8125 0.546875 3.921875 -0.015625 3.953125 -0.328125 C 3.984375 -0.453125 4 -0.59375 4.03125 -0.71875 C 4.359375 -1.703125 4.9375 -3.078125 5.34375 -3.875 C 5.40625 -3.984375 5.578125 -4.3125 5.578125 -4.359375 C 5.578125 -4.453125 5.3125 -4.625 5.296875 -4.625 C 5.265625 -4.625 5.03125 -4.453125 5.046875 -4.5 C 4.53125 -3.5625 4.078125 -2.4375 3.671875 -1.4375 L 4.03125 -1.4375 C 4.015625 -1.75 4 -2.5 3.625 -3.46875 C 3.375 -4.078125 2.8125 -4.734375 2.125 -4.734375 C 0.875 -4.734375 0 -3.046875 0 -2.734375 C 0 -2.640625 0.265625 -2.484375 0.453125 -2.484375 L 0.546875 -2.609375 Z M 0.578125 -2.6875 "/>
</symbol>
<symbol overflow="visible" id="glyph0-4">
<path style="stroke:none;" d="M 1.65625 -1.421875 C 1.25 -0.75 1 -0.671875 0.5625 -0.640625 C 0.4375 -0.625 0.171875 -0.453125 0.171875 -0.265625 C 0.171875 -0.203125 0.40625 0 0.484375 0 C 0.75 0 1.0625 -0.03125 1.328125 -0.03125 C 1.671875 -0.03125 2.015625 0 2.328125 0 C 2.390625 0 2.6875 -0.15625 2.6875 -0.34375 C 2.6875 -0.453125 2.4375 -0.640625 2.359375 -0.640625 C 2.140625 -0.65625 2.0625 -0.5625 2.0625 -0.8125 C 2.0625 -0.9375 2.078125 -0.9375 2.15625 -1.078125 L 2.875 -2.296875 L 5.140625 -2.296875 C 5.140625 -2.25 5.28125 -0.890625 5.28125 -0.796875 C 5.28125 -0.5 4.9375 -0.640625 4.734375 -0.640625 C 4.59375 -0.640625 4.3125 -0.46875 4.3125 -0.265625 C 4.3125 -0.15625 4.609375 0 4.640625 0 C 5.046875 0 5.46875 -0.03125 5.875 -0.03125 C 6.125 -0.03125 6.765625 0 7.015625 0 C 7.0625 0 7.359375 -0.15625 7.359375 -0.359375 C 7.359375 -0.46875 7.09375 -0.640625 6.953125 -0.640625 C 6.34375 -0.640625 6.515625 -0.53125 6.484375 -0.828125 L 5.875 -7.0625 C 5.859375 -7.25 5.6875 -7.46875 5.515625 -7.46875 C 5.359375 -7.46875 5.1875 -7.34375 5.125 -7.25 Z M 3.09375 -2.65625 L 5.0625 -5.953125 L 4.765625 -6.0625 L 5.078125 -2.9375 L 3.265625 -2.9375 Z M 3.09375 -2.65625 "/>
</symbol>
<symbol overflow="visible" id="glyph0-5">
<path style="stroke:none;" d="M 1.421875 -0.9375 C 1.3125 -0.546875 1.46875 -0.640625 0.6875 -0.640625 C 0.515625 -0.640625 0.234375 -0.46875 0.234375 -0.265625 C 0.234375 -0.15625 0.515625 0 0.6875 0 L 4.25 0 C 5.828125 0 7.171875 -1.328125 7.171875 -2.3125 C 7.171875 -3.03125 6.421875 -3.78125 5.453125 -3.890625 L 5.453125 -3.5625 C 6.484375 -3.75 7.703125 -4.640625 7.703125 -5.59375 C 7.703125 -6.328125 6.875 -7.140625 5.6875 -7.140625 L 2.328125 -7.140625 C 2.140625 -7.140625 1.859375 -6.96875 1.859375 -6.765625 C 1.859375 -6.65625 2.140625 -6.5 2.328125 -6.5 C 2.34375 -6.5 2.53125 -6.5 2.703125 -6.484375 C 2.875 -6.453125 2.796875 -6.609375 2.796875 -6.484375 C 2.796875 -6.4375 2.78125 -6.40625 2.75 -6.296875 Z M 3.265625 -3.8125 L 3.890625 -6.28125 C 3.984375 -6.625 3.828125 -6.5 4.25 -6.5 L 5.546875 -6.5 C 6.421875 -6.5 6.453125 -6.078125 6.453125 -5.625 C 6.453125 -4.75 5.765625 -3.984375 4.5625 -3.984375 L 3.3125 -3.984375 Z M 2.65625 -0.640625 C 2.515625 -0.640625 2.5 -0.640625 2.4375 -0.640625 C 2.328125 -0.65625 2.46875 -0.5 2.46875 -0.578125 C 2.46875 -0.609375 2.46875 -0.625 2.515625 -0.8125 L 3.171875 -3.421875 L 4.921875 -3.421875 C 5.875 -3.421875 5.890625 -2.84375 5.890625 -2.421875 C 5.890625 -1.4375 5.1875 -0.640625 4 -0.640625 Z M 2.65625 -0.640625 "/>
</symbol>
<symbol overflow="visible" id="glyph0-6">
<path style="stroke:none;" d="M 7.75 -7.09375 C 7.75 -7.125 7.5625 -7.359375 7.46875 -7.359375 C 7.4375 -7.359375 7.296875 -7.296875 7.1875 -7.1875 L 6.640625 -6.578125 C 6.65625 -6.5625 6.078125 -7.359375 4.96875 -7.359375 C 2.734375 -7.359375 0.3125 -4.984375 0.3125 -2.671875 C 0.3125 -1.03125 1.671875 0.21875 3.203125 0.21875 C 4.0625 0.21875 4.9375 -0.234375 5.46875 -0.6875 C 6.40625 -1.5 6.625 -2.515625 6.625 -2.546875 C 6.625 -2.65625 6.34375 -2.828125 6.328125 -2.828125 C 6.265625 -2.828125 6.046875 -2.625 6.015625 -2.546875 C 5.9375 -2.265625 5.75 -1.671875 5.0625 -1.09375 C 4.375 -0.53125 3.875 -0.421875 3.359375 -0.421875 C 2.46875 -0.421875 1.578125 -0.765625 1.578125 -2.328125 C 1.578125 -2.890625 1.734375 -4.390625 2.734375 -5.5625 C 3.34375 -6.265625 4.15625 -6.71875 5.046875 -6.71875 C 6.0625 -6.71875 6.46875 -6.109375 6.46875 -4.953125 C 6.46875 -4.5625 6.4375 -4.546875 6.4375 -4.453125 C 6.4375 -4.34375 6.734375 -4.1875 6.765625 -4.1875 C 6.890625 -4.1875 7.0625 -4.359375 7.125 -4.546875 Z M 7.75 -7.09375 "/>
</symbol>
<symbol overflow="visible" id="glyph1-0">
<path style="stroke:none;" d=""/>
</symbol>
<symbol overflow="visible" id="glyph1-1">
<path style="stroke:none;" d="M 2.21875 -3.453125 C 2.265625 -3.5625 2.28125 -3.625 2.28125 -3.671875 C 2.28125 -3.890625 1.890625 -4.21875 1.671875 -4.21875 C 1.40625 -4.21875 1.125 -3.84375 1.09375 -3.734375 L 0.171875 -0.703125 C 0.21875 -0.8125 0.125 -0.609375 0.125 -0.59375 C 0.125 -0.515625 0.546875 -0.28125 0.609375 -0.28125 C 0.65625 -0.28125 0.859375 -0.453125 0.90625 -0.5625 Z M 2.21875 -3.453125 "/>
</symbol>
</g>
</defs>
<g id="surface1">
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 113.389094 -0.0008125 C 113.389094 62.624188 62.623469 113.385906 -0.00153125 113.385906 C -62.622625 113.385906 -113.38825 62.624188 -113.38825 -0.0008125 C -113.38825 -62.621906 -62.622625 -113.387531 -0.00153125 -113.387531 C 62.623469 -113.387531 113.389094 -62.621906 113.389094 -0.0008125 Z M 113.389094 -0.0008125 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill:none;stroke-width:0.49814;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(100%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 112.9555 -9.883625 C 115.682062 21.307781 67.326594 51.018719 4.939875 56.47575 C -57.442938 61.936688 -110.224188 41.073406 -112.954656 9.882 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill:none;stroke-width:0.49814;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(100%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -112.954656 9.882 C -115.685125 -21.309406 -67.32575 -51.020344 -4.942938 -56.477375 C 57.443781 -61.934406 110.225031 -41.075031 112.9555 -9.883625 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill:none;stroke-width:0.49814;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,100%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M -80.177313 -80.176594 C -58.036688 -102.317219 -4.192938 -84.368 40.088312 -40.08675 C 84.369562 4.1945 102.318781 58.03825 80.178156 80.178875 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill:none;stroke-width:0.49814;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,100%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 80.178156 80.178875 C 58.037531 102.315594 4.193781 84.370281 -40.087469 40.089031 C -84.368719 -4.192219 -102.317938 -58.035969 -80.177313 -80.176594 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill:none;stroke-width:0.49814;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,100%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 38.779719 -106.551594 C 68.2055 -95.840656 74.693781 -39.453937 53.275812 19.389813 C 31.857844 78.237469 -9.357 117.260906 -38.782781 106.549969 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill:none;stroke-width:0.49814;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,100%);stroke-opacity:1;stroke-miterlimit:10;" d="M -38.782781 106.549969 C -68.204656 95.839031 -74.692938 39.456219 -53.274969 -19.391437 C -31.857 -78.239094 9.357844 -117.258625 38.779719 -106.551594 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill-rule:nonzero;fill:rgb(50%,50%,50%);fill-opacity:0.2;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:0.2;stroke-miterlimit:10;" d="M -62.548406 13.866375 C -57.185125 -12.496906 -51.837469 -27.188312 -39.001531 -50.828937 C -58.181219 -45.660969 -68.790594 -41.246906 -85.978094 -31.293781 C -79.216375 -12.633625 -73.911688 -2.407062 -62.548406 13.866375 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill-rule:nonzero;fill:rgb(100%,50%,0%);fill-opacity:0.2;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:0.2;stroke-miterlimit:10;" d="M 62.54925 -13.868 C 57.185969 12.495281 51.838312 27.186688 39.002375 50.827313 C 58.182062 45.659344 68.791437 41.249188 85.978937 31.292156 C 79.213312 12.632 73.912531 2.409344 62.54925 -13.868 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -61.552313 13.866375 C -61.552313 14.417156 -61.997625 14.862469 -62.548406 14.862469 C -63.099188 14.862469 -63.5445 14.417156 -63.5445 13.866375 C -63.5445 13.315594 -63.099188 12.870281 -62.548406 12.870281 C -61.997625 12.870281 -61.552313 13.315594 -61.552313 13.866375 Z M -61.552313 13.866375 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -38.005438 -50.828937 C -38.005438 -50.278156 -38.45075 -49.832844 -39.001531 -49.832844 C -39.552313 -49.832844 -39.997625 -50.278156 -39.997625 -50.828937 C -39.997625 -51.379719 -39.552313 -51.825031 -39.001531 -51.825031 C -38.45075 -51.825031 -38.005438 -51.379719 -38.005438 -50.828937 Z M -38.005438 -50.828937 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -84.982 -31.293781 C -84.982 -30.743 -85.427313 -30.297687 -85.978094 -30.297687 C -86.528875 -30.297687 -86.974188 -30.743 -86.974188 -31.293781 C -86.974188 -31.844562 -86.528875 -32.289875 -85.978094 -32.289875 C -85.427313 -32.289875 -84.982 -31.844562 -84.982 -31.293781 Z M -84.982 -31.293781 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 63.545344 -13.868 C 63.545344 -13.317219 63.100031 -12.871906 62.54925 -12.871906 C 61.998469 -12.871906 61.553156 -13.317219 61.553156 -13.868 C 61.553156 -14.418781 61.998469 -14.864094 62.54925 -14.864094 C 63.100031 -14.864094 63.545344 -14.418781 63.545344 -13.868 Z M 63.545344 -13.868 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 39.998469 50.827313 C 39.998469 51.378094 39.553156 51.823406 39.002375 51.823406 C 38.451594 51.823406 38.006281 51.378094 38.006281 50.827313 C 38.006281 50.276531 38.451594 49.831219 39.002375 49.831219 C 39.553156 49.831219 39.998469 50.276531 39.998469 50.827313 Z M 39.998469 50.827313 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 86.975031 31.292156 C 86.975031 31.842938 86.525812 32.28825 85.978937 32.28825 C 85.428156 32.28825 84.982844 31.842938 84.982844 31.292156 C 84.982844 30.741375 85.428156 30.296063 85.978937 30.296063 C 86.525812 30.296063 86.975031 30.741375 86.975031 31.292156 Z M 86.975031 31.292156 " transform="matrix(1,0,0,-1,207.857,189.507)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-1" x="139.268" y="191.954"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="150.67" y="230.626"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="125.399" y="219.141"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-1" x="270.036" y="191.35"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="258.883" y="153.369"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="284.603" y="162.225"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-4" x="148.827" y="179.044"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-5" x="172.375" y="236.816"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-6" x="110.527" y="231.128"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-4" x="256.619" y="207.119"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-1" x="264.091" y="203.503"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-5" x="232.487" y="149.688"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-1" x="240.543" y="146.072"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-6" x="297.354" y="154.694"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-1" x="305.187" y="151.078"/>
</g>
</g>
</svg>
</center>
</div>

考虑半圆弧 $ABA'$ 和半圆弧 $ACA'$ 所围成的区域，由于球面关于直径 $AA'$ 是旋转对称的，故 $ABA'$ 和 $ACA'$ 围成的区域面积占球表面积的比例就是 $\alpha$ 占 $2\pi$ 的比值。即
$$ S_{\triangle ABC} + S_{\triangle A' BC} = \frac{\alpha}{2\pi}\cdot 4\pi = 2\alpha .$$
类似的，还有
$$ S_{\triangle ABC} + S_{\triangle AB' C} = 2\beta .$$
以及
$$ S_{\triangle ABC} + S_{\triangle ABC'} = 2\gamma .$$

另一方面，四个三角形 $\triangle ABC$, $\triangle ABC'$, $\triangle A' BC$, $\triangle A' BC'$ 正好拼成半个球面，而 $\triangle A' BC'$ 和 $\triangle AB' C$ 是对称的，所以
$$ S_{\triangle ABC} + S_{\triangle ABC'} + S_{\triangle A' BC} + S_{\triangle AB' C} = 2\pi .$$

通过上述 4 个方程，可以解出
$$ S_{\triangle ABC} = \alpha + \beta + \gamma - \pi .$$

略显意外的是面积竟然只与三个内角之和有关，而不涉及三边弧长。

## 二重积分

另有直接用球面二重积分的解法，我是在《数学传播》上看到这个解法的，见第35卷1期，第51-53页，[HTML](https://web.math.sinica.edu.tw/mathmedia/HTMLarticle18.jsp?mID=35105)，[PDF](https://web.math.sinica.edu.tw/math_media/d351/35105.pdf)。

将球心置于原点，用 $\theta,\phi$ 对球面进行参数化，其中 $\theta$ 代表经度，$\phi$ 代表球面上的点和球心的连线与 $z^+$ 轴的夹角，$\theta\in[0,2\pi)$, $\phi\in[0,\pi]$，
则 $\theta, \phi$ 与 $x,y,z$ 的关系为
$$x = \sin\phi \cos\theta, \qquad y = \sin\phi \sin\theta, \qquad z = \cos\phi .$$

注意到任意三角形都可以分成两个直角三角形的和或差，因此下面只考虑球面上直角三角形的面积。
不失一般性，可以将 $A$ 点置于北极点，$C$ 点置于 $xz$ 平面，$B$ 点的 $y$ 坐标大于 $0$，$\angle ACB = 90\degree$，如下图所示。

<div>
<center>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="290pt" height="280pt" viewBox="90 68 290 280" version="1.1">
<defs>
<g>
<symbol overflow="visible" id="glyph3-0">
<path style="stroke:none;" d=""/>
</symbol>
<symbol overflow="visible" id="glyph3-1">
<path style="stroke:none;" d="M 7.546875 -4.5 C 7.546875 -6.109375 6.3125 -7.359375 4.828125 -7.359375 C 2.6875 -7.359375 0.3125 -4.921875 0.3125 -2.609375 C 0.3125 -0.953125 1.609375 0.21875 3.046875 0.21875 C 5.15625 0.21875 7.546875 -2.125 7.546875 -4.5 Z M 3.09375 -0.375 C 2.109375 -0.375 1.578125 -1 1.578125 -2.328125 C 1.578125 -2.765625 1.671875 -4.109375 2.4375 -5.28125 C 3.125 -6.3125 3.984375 -6.78125 4.78125 -6.78125 C 5.59375 -6.78125 6.3125 -6.375 6.3125 -4.890625 C 6.3125 -4.171875 6.09375 -2.734375 5.109375 -1.515625 C 4.625 -0.90625 3.9375 -0.375 3.09375 -0.375 Z M 3.09375 -0.375 "/>
</symbol>
<symbol overflow="visible" id="glyph3-2">
<path style="stroke:none;" d="M 3.5 -3.171875 C 3.5625 -3.421875 3.625 -4.1875 4.3125 -4.1875 C 4.359375 -4.1875 4.46875 -4.234375 4.6875 -4.109375 L 4.8125 -4.390625 C 4.53125 -4.34375 4.15625 -3.921875 4.15625 -3.671875 C 4.15625 -3.515625 4.453125 -3.171875 4.71875 -3.171875 C 4.9375 -3.171875 5.421875 -3.515625 5.421875 -3.90625 C 5.421875 -4.421875 4.671875 -4.734375 4.328125 -4.734375 C 3.75 -4.734375 3.265625 -4.15625 3.296875 -4.203125 C 3.203125 -4.46875 2.5 -4.734375 2.203125 -4.734375 C 1.171875 -4.734375 0.421875 -3.28125 0.421875 -3.03125 C 0.421875 -2.9375 0.703125 -2.765625 0.71875 -2.765625 C 0.796875 -2.765625 1 -2.953125 1.015625 -3.046875 C 1.359375 -4.09375 1.84375 -4.1875 2.1875 -4.1875 C 2.375 -4.1875 2.546875 -4.25 2.546875 -3.671875 C 2.546875 -3.375 2.375 -2.703125 2 -1.3125 C 1.84375 -0.6875 1.671875 -0.4375 1.234375 -0.4375 C 1.171875 -0.4375 1.0625 -0.390625 0.859375 -0.515625 L 0.734375 -0.234375 C 0.984375 -0.296875 1.375 -0.65625 1.375 -0.9375 C 1.375 -1.203125 0.984375 -1.453125 0.84375 -1.453125 C 0.53125 -1.453125 0.109375 -1.03125 0.109375 -0.703125 C 0.109375 -0.25 0.78125 0.109375 1.21875 0.109375 C 1.890625 0.109375 2.359375 -0.640625 2.390625 -0.703125 L 2.09375 -0.8125 C 2.21875 -0.4375 2.75 0.109375 3.34375 0.109375 C 4.375 0.109375 5.109375 -1.328125 5.109375 -1.578125 C 5.109375 -1.6875 4.859375 -1.859375 4.828125 -1.859375 C 4.734375 -1.859375 4.53125 -1.640625 4.515625 -1.578125 C 4.1875 -0.515625 3.6875 -0.4375 3.375 -0.4375 C 2.984375 -0.4375 2.984375 -0.59375 2.984375 -0.921875 C 2.984375 -1.140625 3.046875 -1.359375 3.15625 -1.796875 Z M 3.5 -3.171875 "/>
</symbol>
<symbol overflow="visible" id="glyph3-3">
<path style="stroke:none;" d="M 5.015625 -3.953125 C 5.046875 -4.09375 5.046875 -4.109375 5.046875 -4.1875 C 5.046875 -4.359375 4.75 -4.625 4.59375 -4.625 C 4.5 -4.625 4.203125 -4.515625 4.109375 -4.34375 C 4.046875 -4.203125 3.96875 -3.890625 3.921875 -3.703125 C 3.859375 -3.453125 3.78125 -3.1875 3.734375 -2.90625 L 3.28125 -1.109375 C 3.234375 -0.96875 2.984375 -0.4375 2.328125 -0.4375 C 1.828125 -0.4375 1.890625 -0.703125 1.890625 -1.078125 C 1.890625 -1.53125 2.046875 -2.15625 2.390625 -3.03125 C 2.546875 -3.4375 2.59375 -3.546875 2.59375 -3.75 C 2.59375 -4.203125 2.109375 -4.734375 1.609375 -4.734375 C 0.65625 -4.734375 0.109375 -3.125 0.109375 -3.03125 C 0.109375 -2.9375 0.390625 -2.765625 0.40625 -2.765625 C 0.515625 -2.765625 0.6875 -2.953125 0.734375 -3.109375 C 1 -4.046875 1.234375 -4.1875 1.578125 -4.1875 C 1.65625 -4.1875 1.640625 -4.34375 1.640625 -4.03125 C 1.640625 -3.78125 1.546875 -3.515625 1.46875 -3.328125 C 1.078125 -2.265625 0.890625 -1.703125 0.890625 -1.234375 C 0.890625 -0.34375 1.703125 0.109375 2.296875 0.109375 C 2.6875 0.109375 3.140625 -0.109375 3.421875 -0.390625 L 3.125 -0.5 C 2.984375 0.015625 2.921875 0.390625 2.515625 0.921875 C 2.265625 1.25 2.015625 1.5 1.5625 1.5 C 1.421875 1.5 1.140625 1.640625 1.03125 1.40625 C 0.953125 1.40625 1.203125 1.359375 1.34375 1.234375 C 1.453125 1.140625 1.59375 0.90625 1.59375 0.71875 C 1.59375 0.40625 1.15625 0.203125 1.0625 0.203125 C 0.828125 0.203125 0.3125 0.53125 0.3125 1.015625 C 0.3125 1.515625 0.9375 2.046875 1.5625 2.046875 C 2.578125 2.046875 3.78125 0.984375 4.0625 -0.15625 Z M 5.015625 -3.953125 "/>
</symbol>
<symbol overflow="visible" id="glyph3-4">
<path style="stroke:none;" d="M 1.453125 -0.875 C 1.984375 -1.453125 2.265625 -1.703125 2.6875 -2.046875 C 2.6875 -2.140625 3.25 -2.546875 3.609375 -2.90625 C 4.5625 -3.84375 4.828125 -4.421875 4.828125 -4.46875 C 4.828125 -4.5625 4.5625 -4.734375 4.546875 -4.734375 C 4.46875 -4.734375 4.3125 -4.671875 4.265625 -4.578125 C 3.96875 -4.09375 3.890625 -3.984375 3.65625 -3.984375 C 3.40625 -3.984375 3.40625 -4.09375 3.265625 -4.25 C 3.078125 -4.484375 2.78125 -4.734375 2.453125 -4.734375 C 1.703125 -4.734375 1.0625 -3.640625 1.0625 -3.421875 C 1.0625 -3.375 1.28125 -3.15625 1.359375 -3.15625 C 1.453125 -3.15625 1.640625 -3.375 1.671875 -3.421875 C 1.859375 -3.890625 2.265625 -3.734375 2.34375 -3.734375 C 2.546875 -3.734375 2.734375 -3.671875 2.96875 -3.59375 C 3.375 -3.4375 3.484375 -3.4375 3.375 -3.4375 C 3.25 -3.296875 2.40625 -2.578125 2.21875 -2.40625 L 1.328125 -1.578125 C 0.640625 -0.90625 0.25 -0.21875 0.25 -0.15625 C 0.25 -0.046875 0.53125 0.109375 0.546875 0.109375 C 0.625 0.109375 0.765625 0.046875 0.828125 -0.0625 C 1.0625 -0.421875 1.234375 -0.640625 1.5625 -0.640625 C 1.78125 -0.640625 1.75 -0.59375 2 -0.3125 C 2.171875 -0.09375 2.484375 0.109375 2.765625 0.109375 C 3.765625 0.109375 4.5 -1.3125 4.5 -1.578125 C 4.5 -1.640625 4.296875 -1.859375 4.21875 -1.859375 C 4.125 -1.859375 3.921875 -1.625 3.890625 -1.5625 C 3.671875 -0.90625 3.203125 -0.890625 2.875 -0.890625 C 2.6875 -0.890625 2.5 -0.953125 2.296875 -1.015625 C 1.953125 -1.140625 1.796875 -1.1875 1.59375 -1.1875 C 1.578125 -1.1875 1.421875 -1.1875 1.328125 -1.15625 Z M 1.453125 -0.875 "/>
</symbol>
<symbol overflow="visible" id="glyph3-5">
<path style="stroke:none;" d="M 1.421875 -0.9375 C 1.3125 -0.546875 1.46875 -0.640625 0.6875 -0.640625 C 0.515625 -0.640625 0.234375 -0.46875 0.234375 -0.265625 C 0.234375 -0.15625 0.515625 0 0.6875 0 L 4.25 0 C 5.828125 0 7.171875 -1.328125 7.171875 -2.3125 C 7.171875 -3.03125 6.421875 -3.78125 5.453125 -3.890625 L 5.453125 -3.5625 C 6.484375 -3.75 7.703125 -4.640625 7.703125 -5.59375 C 7.703125 -6.328125 6.875 -7.140625 5.6875 -7.140625 L 2.328125 -7.140625 C 2.140625 -7.140625 1.859375 -6.96875 1.859375 -6.765625 C 1.859375 -6.65625 2.140625 -6.5 2.328125 -6.5 C 2.34375 -6.5 2.53125 -6.5 2.703125 -6.484375 C 2.875 -6.453125 2.796875 -6.609375 2.796875 -6.484375 C 2.796875 -6.4375 2.78125 -6.40625 2.75 -6.296875 Z M 3.265625 -3.8125 L 3.890625 -6.28125 C 3.984375 -6.625 3.828125 -6.5 4.25 -6.5 L 5.546875 -6.5 C 6.421875 -6.5 6.453125 -6.078125 6.453125 -5.625 C 6.453125 -4.75 5.765625 -3.984375 4.5625 -3.984375 L 3.3125 -3.984375 Z M 2.65625 -0.640625 C 2.515625 -0.640625 2.5 -0.640625 2.4375 -0.640625 C 2.328125 -0.65625 2.46875 -0.5 2.46875 -0.578125 C 2.46875 -0.609375 2.46875 -0.625 2.515625 -0.8125 L 3.171875 -3.421875 L 4.921875 -3.421875 C 5.875 -3.421875 5.890625 -2.84375 5.890625 -2.421875 C 5.890625 -1.4375 5.1875 -0.640625 4 -0.640625 Z M 2.65625 -0.640625 "/>
</symbol>
<symbol overflow="visible" id="glyph3-6">
<path style="stroke:none;" d="M 1.65625 -1.421875 C 1.25 -0.75 1 -0.671875 0.5625 -0.640625 C 0.4375 -0.625 0.171875 -0.453125 0.171875 -0.265625 C 0.171875 -0.203125 0.40625 0 0.484375 0 C 0.75 0 1.0625 -0.03125 1.328125 -0.03125 C 1.671875 -0.03125 2.015625 0 2.328125 0 C 2.390625 0 2.6875 -0.15625 2.6875 -0.34375 C 2.6875 -0.453125 2.4375 -0.640625 2.359375 -0.640625 C 2.140625 -0.65625 2.0625 -0.5625 2.0625 -0.8125 C 2.0625 -0.9375 2.078125 -0.9375 2.15625 -1.078125 L 2.875 -2.296875 L 5.140625 -2.296875 C 5.140625 -2.25 5.28125 -0.890625 5.28125 -0.796875 C 5.28125 -0.5 4.9375 -0.640625 4.734375 -0.640625 C 4.59375 -0.640625 4.3125 -0.46875 4.3125 -0.265625 C 4.3125 -0.15625 4.609375 0 4.640625 0 C 5.046875 0 5.46875 -0.03125 5.875 -0.03125 C 6.125 -0.03125 6.765625 0 7.015625 0 C 7.0625 0 7.359375 -0.15625 7.359375 -0.359375 C 7.359375 -0.46875 7.09375 -0.640625 6.953125 -0.640625 C 6.34375 -0.640625 6.515625 -0.53125 6.484375 -0.828125 L 5.875 -7.0625 C 5.859375 -7.25 5.6875 -7.46875 5.515625 -7.46875 C 5.359375 -7.46875 5.1875 -7.34375 5.125 -7.25 Z M 3.09375 -2.65625 L 5.0625 -5.953125 L 4.765625 -6.0625 L 5.078125 -2.9375 L 3.265625 -2.9375 Z M 3.09375 -2.65625 "/>
</symbol>
<symbol overflow="visible" id="glyph3-7">
<path style="stroke:none;" d="M 7.75 -7.09375 C 7.75 -7.125 7.5625 -7.359375 7.46875 -7.359375 C 7.4375 -7.359375 7.296875 -7.296875 7.1875 -7.1875 L 6.640625 -6.578125 C 6.65625 -6.5625 6.078125 -7.359375 4.96875 -7.359375 C 2.734375 -7.359375 0.3125 -4.984375 0.3125 -2.671875 C 0.3125 -1.03125 1.671875 0.21875 3.203125 0.21875 C 4.0625 0.21875 4.9375 -0.234375 5.46875 -0.6875 C 6.40625 -1.5 6.625 -2.515625 6.625 -2.546875 C 6.625 -2.65625 6.34375 -2.828125 6.328125 -2.828125 C 6.265625 -2.828125 6.046875 -2.625 6.015625 -2.546875 C 5.9375 -2.265625 5.75 -1.671875 5.0625 -1.09375 C 4.375 -0.53125 3.875 -0.421875 3.359375 -0.421875 C 2.46875 -0.421875 1.578125 -0.765625 1.578125 -2.328125 C 1.578125 -2.890625 1.734375 -4.390625 2.734375 -5.5625 C 3.34375 -6.265625 4.15625 -6.71875 5.046875 -6.71875 C 6.0625 -6.71875 6.46875 -6.109375 6.46875 -4.953125 C 6.46875 -4.5625 6.4375 -4.546875 6.4375 -4.453125 C 6.4375 -4.34375 6.734375 -4.1875 6.765625 -4.1875 C 6.890625 -4.1875 7.0625 -4.359375 7.125 -4.546875 Z M 7.75 -7.09375 "/>
</symbol>
<symbol overflow="visible" id="glyph3-8">
<path style="stroke:none;" d="M 4.703125 -5.140625 C 4.703125 -5.796875 4.359375 -7.359375 3.34375 -7.359375 C 1.953125 -7.359375 0.234375 -4.375 0.234375 -2.09375 C 0.234375 -1.15625 0.703125 0.109375 1.609375 0.109375 C 3.015625 0.109375 4.703125 -2.90625 4.703125 -5.140625 Z M 1.640625 -3.78125 C 1.8125 -4.421875 1.96875 -5.109375 2.359375 -5.8125 C 2.625 -6.296875 2.875 -6.8125 3.328125 -6.8125 C 3.8125 -6.8125 3.703125 -6.328125 3.703125 -5.765625 C 3.703125 -5.28125 3.625 -4.765625 3.421875 -3.953125 L 1.6875 -3.953125 Z M 3.296875 -3.453125 C 3.1875 -3 3.015625 -2.265625 2.640625 -1.5625 C 2.296875 -0.875 2.046875 -0.4375 1.609375 -0.4375 C 1.28125 -0.4375 1.25 -0.5625 1.25 -1.484375 C 1.25 -1.90625 1.3125 -2.484375 1.515625 -3.296875 L 3.25 -3.296875 Z M 3.296875 -3.453125 "/>
</symbol>
<symbol overflow="visible" id="glyph3-9">
<path style="stroke:none;" d="M 4.53125 -6.84375 C 4.53125 -6.859375 4.5625 -6.96875 4.5625 -6.984375 C 4.5625 -6.984375 4.390625 -7.25 4.265625 -7.25 C 4.171875 -7.25 3.984375 -7.046875 3.9375 -6.875 L 3.40625 -4.75 C 1.953125 -4.6875 0.3125 -3.203125 0.3125 -1.84375 C 0.3125 -0.890625 1.1875 0.046875 2.1875 0.109375 C 2.140625 0.265625 2.078125 0.59375 2 0.890625 C 1.875 1.359375 1.78125 1.75 1.78125 1.78125 C 1.78125 1.875 2.03125 2.046875 2.078125 2.046875 C 2.125 2.046875 2.265625 1.984375 2.296875 1.953125 C 2.3125 1.9375 2.421875 1.578125 2.453125 1.453125 L 2.796875 0.125 C 4.265625 0.0625 5.875 -1.4375 5.875 -2.765625 C 5.875 -3.5625 5.1875 -4.640625 4 -4.734375 Z M 2.453125 -0.421875 C 1.859375 -0.453125 1.3125 -0.640625 1.3125 -1.640625 C 1.3125 -2.828125 2 -4.0625 3.265625 -4.171875 L 2.328125 -0.4375 Z M 3.734375 -4.203125 C 4.5 -4.15625 4.890625 -3.859375 4.890625 -2.984375 C 4.890625 -1.796875 4.203125 -0.546875 2.921875 -0.453125 L 3.859375 -4.1875 Z M 3.734375 -4.203125 "/>
</symbol>
<symbol overflow="visible" id="glyph1-0">
<path style="stroke:none;" d=""/>
</symbol>
<symbol overflow="visible" id="glyph1-1">
<path style="stroke:none;" d="M 2.515625 -4.625 C 2.515625 -4.8125 2.328125 -5.015625 2.046875 -5.015625 C 1.546875 -4.515625 1.046875 -4.578125 0.5625 -4.578125 L 0.5625 -3.9375 C 0.921875 -3.9375 1.515625 -3.984375 1.578125 -4.015625 L 1.578125 -0.765625 C 1.578125 -0.53125 1.765625 -0.640625 1.078125 -0.640625 L 0.609375 -0.640625 L 0.609375 0.015625 C 0.9375 0 1.796875 -0.03125 2.046875 -0.03125 C 2.265625 -0.03125 3.140625 0 3.484375 0.015625 L 3.484375 -0.640625 L 3.03125 -0.640625 C 2.328125 -0.640625 2.515625 -0.53125 2.515625 -0.765625 Z M 2.515625 -4.625 "/>
</symbol>
<symbol overflow="visible" id="glyph1-2">
<path style="stroke:none;" d="M 3.78125 -2.421875 C 3.78125 -3.1875 3.640625 -3.875 3.3125 -4.359375 C 3.09375 -4.671875 2.53125 -5.015625 1.984375 -5.015625 C 0.359375 -5.015625 0.171875 -2.921875 0.171875 -2.421875 C 0.171875 -1.921875 0.359375 0.140625 1.984375 0.140625 C 3.59375 0.140625 3.78125 -1.921875 3.78125 -2.421875 Z M 1.984375 -0.453125 C 1.65625 -0.453125 1.421875 -0.4375 1.28125 -1.015625 C 1.1875 -1.421875 1.1875 -2 1.1875 -2.515625 C 1.1875 -3.015625 1.1875 -3.546875 1.296875 -3.9375 C 1.4375 -4.484375 1.6875 -4.4375 1.984375 -4.4375 C 2.359375 -4.4375 2.515625 -4.390625 2.640625 -4 C 2.765625 -3.609375 2.765625 -3.109375 2.765625 -2.515625 C 2.765625 -2 2.765625 -1.484375 2.671875 -1.03125 C 2.53125 -0.40625 2.265625 -0.453125 1.984375 -0.453125 Z M 1.984375 -0.453125 "/>
</symbol>
<symbol overflow="visible" id="glyph2-0">
<path style="stroke:none;" d=""/>
</symbol>
<symbol overflow="visible" id="glyph2-1">
<path style="stroke:none;" d="M 6.84375 -3.265625 C 7 -3.265625 7.359375 -3.421875 7.359375 -3.625 C 7.359375 -3.8125 7 -3.984375 6.859375 -3.984375 L 0.890625 -3.984375 C 0.75 -3.984375 0.375 -3.8125 0.375 -3.625 C 0.375 -3.421875 0.75 -3.265625 0.890625 -3.265625 Z M 6.859375 -1.328125 C 7 -1.328125 7.359375 -1.484375 7.359375 -1.6875 C 7.359375 -1.890625 7 -2.046875 6.84375 -2.046875 L 0.890625 -2.046875 C 0.75 -2.046875 0.375 -1.890625 0.375 -1.6875 C 0.375 -1.484375 0.75 -1.328125 0.890625 -1.328125 Z M 6.859375 -1.328125 "/>
</symbol>
</g>
</defs>
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(89.99939%,89.99939%,89.99939%);fill-opacity:1;" d="M 330.640625 227.90625 C 330.640625 205.988281 279.878906 188.21875 217.253906 188.21875 C 154.632813 188.21875 103.867188 205.988281 103.867188 227.90625 C 103.867188 249.824219 154.632813 267.589844 217.253906 267.589844 C 279.878906 267.589844 330.640625 249.824219 330.640625 227.90625 Z M 330.640625 227.90625 "/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 113.385625 -0.00125 C 113.385625 21.916719 62.623906 39.68625 -0.00109375 39.68625 C -62.622187 39.68625 -113.387813 21.916719 -113.387813 -0.00125 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -113.387813 -0.00125 C -113.387813 -21.919219 -62.622187 -39.684844 -0.00109375 -39.684844 C 62.623906 -39.684844 113.385625 -21.919219 113.385625 -0.00125 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,100%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -0.00109375 113.385469 C -31.309687 113.385469 -56.6925 62.62375 -56.6925 -0.00125 C -56.6925 -62.622344 -31.309687 -113.387969 -0.00109375 -113.387969 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(100%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -0.00109375 -113.387969 C 15.655156 -113.387969 28.346563 -62.622344 28.346563 -0.00125 C 28.346563 62.62375 15.655156 113.385469 -0.00109375 113.385469 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,100%);stroke-opacity:1;stroke-miterlimit:10;" d="M 106.549688 -38.7825 C 119.40125 -3.473906 82.116094 42.510469 23.268438 63.928438 C -35.579219 85.346406 -93.700312 74.088594 -106.547969 38.78 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 113.385625 -0.00125 C 113.385625 62.62375 62.623906 113.385469 -0.00109375 113.385469 C -62.622187 113.385469 -113.387813 62.62375 -113.387813 -0.00125 C -113.387813 -62.622344 -62.622187 -113.387969 -0.00109375 -113.387969 C 62.623906 -113.387969 113.385625 -62.622344 113.385625 -0.00125 Z M 113.385625 -0.00125 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -0.00109375 -0.00125 L -121.4425 -78.610625 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 6.055468 0.000338067 L 1.607636 1.683637 L 3.086625 0.000323809 L 1.610854 -1.682814 Z M 6.055468 0.000338067 " transform="matrix(-0.83945,0.5434,0.5434,0.83945,98.19636,304.9748)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -0.00109375 -0.00125 L -0.0167187 151.272188 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 6.052382 0.00151407 L 1.607132 1.681635 L 3.087479 0.00178091 L 1.60683 -1.681713 Z M 6.052382 0.00151407 " transform="matrix(-0.00009,-0.99998,-0.99998,0.00009,217.24034,79.47023)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M -0.00109375 -0.00125 L -42.676875 74.604219 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 26.666875 -38.598906 L -0.00109375 -0.00125 L 23.412969 63.869844 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -0.00109375 -0.00125 L 155.705938 -54.919219 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 6.053319 0.000353196 L 1.607166 1.683868 L 3.08812 -0.00164013 L 1.609944 -1.682859 Z M 6.053319 0.000353196 " transform="matrix(0.94301,0.33261,0.33261,-0.94301,370.28373,281.88147)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 24.409063 63.869844 C 24.409063 64.420625 23.96375 64.865938 23.412969 64.865938 C 22.862188 64.865938 22.416875 64.420625 22.416875 63.869844 C 22.416875 63.319063 22.862188 62.87375 23.412969 62.87375 C 23.96375 62.87375 24.409063 63.319063 24.409063 63.869844 Z M 24.409063 63.869844 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -41.680781 74.604219 C -41.680781 75.155 -42.126094 75.600313 -42.676875 75.600313 C -43.227656 75.600313 -43.672969 75.155 -43.672969 74.604219 C -43.672969 74.053438 -43.227656 73.608125 -42.676875 73.608125 C -42.126094 73.608125 -41.680781 74.053438 -41.680781 74.604219 Z M -41.680781 74.604219 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 0.983281 113.385469 C 0.983281 113.93625 0.537969 114.381563 -0.0128125 114.381563 C -0.563594 114.381563 -1.008906 113.93625 -1.008906 113.385469 C -1.008906 112.838594 -0.563594 112.389375 -0.0128125 112.389375 C 0.537969 112.389375 0.983281 112.838594 0.983281 113.385469 Z M 0.983281 113.385469 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 0.995 -0.00125 C 0.995 0.549531 0.549688 0.994844 -0.00109375 0.994844 C -0.551875 0.994844 -0.997187 0.549531 -0.997187 -0.00125 C -0.997187 -0.552031 -0.551875 -0.997344 -0.00109375 -0.997344 C 0.549688 -0.997344 0.995 -0.552031 0.995 -0.00125 Z M 0.995 -0.00125 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -52.946406 -34.919219 C -52.946406 -34.368437 -53.395625 -33.923125 -53.9425 -33.923125 C -54.493281 -33.923125 -54.938594 -34.368437 -54.938594 -34.919219 C -54.938594 -35.47 -54.493281 -35.915312 -53.9425 -35.915312 C -53.395625 -35.915312 -52.946406 -35.47 -52.946406 -34.919219 Z M -52.946406 -34.919219 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 27.662969 -38.598906 C 27.662969 -38.052031 27.217656 -37.602812 26.666875 -37.602812 C 26.12 -37.602812 25.670781 -38.052031 25.670781 -38.598906 C 25.670781 -39.149687 26.12 -39.595 26.666875 -39.595 C 27.217656 -39.595 27.662969 -39.149687 27.662969 -38.598906 Z M 27.662969 -38.598906 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 80.877813 -28.177031 C 80.877813 -27.62625 80.4325 -27.180937 79.881719 -27.180937 C 79.330938 -27.180937 78.885625 -27.62625 78.885625 -28.177031 C 78.885625 -28.727812 79.330938 -29.173125 79.881719 -29.173125 C 80.4325 -29.173125 80.877813 -28.727812 80.877813 -28.177031 Z M 80.877813 -28.177031 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph3-1" x="221.821" y="225.639"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph3-2" x="95.351" y="317.925"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph3-3" x="367.707" y="292.578"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph3-4" x="223.223" y="79.812"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph3-5" x="244.188" y="160.516"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph3-6" x="220.763" y="110.998"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph3-7" x="163.225" y="149.781"/>
</g>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -10.645625 -7.009062 C -5.8175 -7.9075 -0.22375 -8.165312 5.100469 -7.731719 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph3-8" x="196.397" y="250.069"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-1" x="201.074" y="251.563"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph2-1" x="208.31" y="250.069"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph3-6" x="218.826" y="250.069"/>
</g>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -0.00109375 22.678438 C -3.352656 22.678438 -6.532344 19.709688 -8.684687 14.576875 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph3-9" x="203.306" y="201.602"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-2" x="209.242" y="203.096"/>
</g>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -0.00109375 34.018281 C 3.389531 34.018281 6.702031 31.990938 9.510625 28.201875 " transform="matrix(1,0,0,-1,217.255,227.905)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph3-9" x="220.438" y="186.481"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-1" x="226.374" y="187.975"/>
</g>
</g>
</svg>
</center>
</div>

$A,B,C$ 三点的坐标分别为：
$$
\begin{aligned}
A &= (0, 0, 1) \\\ 
B &= (\sin\phi_1\cos A, \sin\phi_1\sin A, \cos\phi_1) \\\ 
C &= (\sin\phi_0, 0, \cos\phi_0)
\end{aligned}
$$

因为 $\angle C = 90\degree$，则弧线 $\overset{\frown}{CB}$ 所在的大圆平面与 $xz$ 平面垂直，
设这个大圆的法向量为 $\vec{v} = (l,m,n)$，则由$\vec{v}$ 垂直于 $y$ 轴可得 $m=0$，并由 $\vec{v}\perp\vec{OB}$ 和 $\vec{v}\perp\vec{OC}$，可进一步得
$$
\begin{aligned}
& l\cdot\sin\phi_1\cos A + n\cdot \cos\phi_1 = 0\\\ 
& l\cdot\sin\phi_0 + n\cdot\cos\phi_0 = 0 
\end{aligned}
$$
这样就相当于 $l,m,n$ 都已知了。
将 $l,n$ 都乘以 $-1$，得到的向量依然是平面 $OBC$ 的法向量，因此在后面的计算中，总是取 $l \le 0$ 的情况。

对于 $\triangle ABC$ 区域求积分，外层对 $\theta$ 积分，范围是 $\theta\in[0,A]$。
内层对 $\phi$ 积分，积分下限是 $\phi = 0$，上限到弧线 $\overset{\frown}{CB}$ 为止。
设弧线 $\overset{\frown}{CB}$ 上的点的球面参数坐标为 $P = (\theta,\phi)$，需要满足 $\vec{v}\perp\vec{OB}$，即
$$ l\cdot\sin\phi\cos\theta + n\cdot\cos\phi = 0 , $$
当外层的 $\theta$ 给定时，内存的积分上限可由上式得出：
$$ \cot \phi_\theta = -\frac{l}{n}\cos\theta , $$
或
$$ \cos \phi_\theta = \frac{-l\cos\theta}{\sqrt{n^2+l^2\cos^2\theta}} . $$

于是 $\triangle ABC$ 的面积为 
$$
\begin{aligned}
S &= \int_{\theta=0}^A\int_{\phi=0}^{\phi_\theta} \sin\phi\ \mathrm{d}\phi\ \mathrm{d}\theta \\\ 
&= \int_{\theta=0}^A \int_{\cos\phi=1}^{\cos\phi_\theta} -1\ \mathrm{d}\cos\phi\ \mathrm{d}\theta \\\ 
&= \int_{\theta=0}^A \left( 1 + \frac{l\cos\theta}{\sqrt{n^2+l^2\cos^2\theta}} \right)\mathrm{d}\theta \\\ 
&= A + \int_{\theta=0}^A \frac{l\cos\theta}{\sqrt{n^2+l^2\cos^2\theta}}\ \mathrm{d}\theta
\end{aligned}
$$
令 $t=\sin\theta$，则积分下限和上限为 $t = 0$ 和 $t = \sin A$，则
$$
\begin{aligned}
\int \frac{l\cos\theta}{\sqrt{n^2+l^2\cos^2\theta}}\ \mathrm{d}\theta &= \int \frac{l}{\sqrt{l^2+n^2-l^2t^2}}\ \mathrm{d}t\\\ 
&= \arcsin\frac{lt}{\sqrt{l^2+n^2}} \\\ 
&= \frac{\pi}{2} - \arccos\frac{lt}{\sqrt{l^2+n^2}}\\\ 
\int_{\theta=0}^A \frac{l\cos\theta}{\sqrt{n^2+l^2\cos^2\theta}}\ \mathrm{d}\theta &= \frac{\pi}{2} - \arccos\frac{lt}{\sqrt{l^2+n^2}}\ \bigg|_0^{\sin A} \\\ 
&= \frac{\pi}{2} - \arccos\frac{l\sin A}{\sqrt{l^2+n^2}}
\end{aligned}
$$

然后计算 $\angle B$。
因为 $B$ 是平面 $OAB$ 和平面 $OBC$ 的夹角，也就是这两个平面法线的夹角，而法线分别为 $(l,0,n)$ 和 $(-\sin A, \cos A, 0)$，对他们求内积得
$$
\begin{aligned}
\cos B &= \frac{-l \sin A}{\sqrt{l^2+n^2}}, \\\ 
\cos(\pi-B) &= -\cos B = \frac{l \sin A}{\sqrt{l^2+n^2}}.
\end{aligned}
$$

注意到 $\angle C = \dfrac{\pi}{2}$，于是
$$
\begin{aligned}
S &= A + \frac{\pi}{2} - \arccos\frac{l\sin A}{\sqrt{l^2+n^2}} \\\ 
&= A + \frac{\pi}{2} - (\pi - B) \\\ 
& = A + B - \frac{\pi}{2} \\\ 
& = A + B + C - \pi.
\end{aligned}
$$

## 推广

球面上的 $N$ 边形可以被分割成 $N-2$ 个三角形，每个三角形的面积的面积只与内角之和有关，因此单位球面上的多边形面积（或立体角）就等于这些三角形的面积之和，也就是多边形内角之和减去 $(N-2)\pi$。

## 案例

在 UE4 path tracing 的 shader 代码中，其中一步计算是面光源在着色点上的立体角。给定三维空间中的一个矩形和一个点，如何计算从这个点看上去矩形所占的立体角呢？下面的代码展示了过程。

``` cpp
struct FRect
{
	float3		Origin;
	float3x3	Axis;
	float2		Extent;
	float2		FullExtent;
	float2		Offset;
};

// Rectangle projected to a sphere
// [Urena et al. 2013, "An Area-Preserving Parametrization for Spherical Rectangles"]
struct FSphericalRect
{
	float3x3	Axis;

	float		x0;
	float		x1;
	float		y0;
	float		y1;
	float		z0;

	float		b0;
	float		b1;
	float		k;
	float		SolidAngle;
};

// RectZ must face origin
FSphericalRect BuildSphericalRect( FRect Rect )
{
	FSphericalRect SphericalRect;

	SphericalRect.Axis = Rect.Axis;

	float3 LocalPosition;
	LocalPosition.x = dot( Rect.Axis[0], Rect.Origin );
	LocalPosition.y = dot( Rect.Axis[1], Rect.Origin );
	LocalPosition.z = dot( Rect.Axis[2], Rect.Origin );

	SphericalRect.x0 = LocalPosition.x - Rect.Extent.x;
	SphericalRect.x1 = LocalPosition.x + Rect.Extent.x;
	SphericalRect.y0 = LocalPosition.y - Rect.Extent.y;
	SphericalRect.y1 = LocalPosition.y + Rect.Extent.y;
	SphericalRect.z0 = -abs( LocalPosition.z );

	SphericalRect.Axis[2] *= LocalPosition.z > 0 ? -1 : 1;

	float3 v0 = float3( SphericalRect.x0, SphericalRect.y0, SphericalRect.z0 );
	float3 v1 = float3( SphericalRect.x1, SphericalRect.y0, SphericalRect.z0 );
	float3 v2 = float3( SphericalRect.x1, SphericalRect.y1, SphericalRect.z0 );
	float3 v3 = float3( SphericalRect.x0, SphericalRect.y1, SphericalRect.z0 );

	float3 n0 = normalize( cross( v0, v1 ) );
	float3 n1 = normalize( cross( v1, v2 ) );
	float3 n2 = normalize( cross( v2, v3 ) );
	float3 n3 = normalize( cross( v3, v0 ) );

	float g0 = acos( -dot( n0, n1 ) );
	float g1 = acos( -dot( n1, n2 ) );
	float g2 = acos( -dot( n2, n3 ) );
	float g3 = acos( -dot( n3, n0 ) );

	SphericalRect.b0 = n0.z;
	SphericalRect.b1 = n2.z;

	SphericalRect.k = 2*PI - g2 - g3;
	SphericalRect.SolidAngle = g0 + g1 - SphericalRect.k;

	return SphericalRect;
}
```

在空间矩形的局部坐标系下，矩形的长宽沿 $x$ 和 $y$ 轴，原点位于矩形中心。代码先计算着色点在这个局部坐标系的位置，然后计算局部坐标系着色点与矩形四个顶点分别构成的向量，然后将矩形投影到以着色点为中心的球面上，求出这个球面矩形四条边所在平面的法线，并进而得到四个球面角大小。将四角之和减去 $2\pi$ 就是空间矩形在着色点看来的立体角大小。