---
title: "福特圆可视化"
date: 2022-10-11T22:33:10+08:00
categories: ["数学"]
---

## 福特圆

以下科普部分摘自 [Wikipedia | Ford circle](https://en.wikipedia.org/wiki/Ford_circle)

福特圆是欧氏平面上的一组圆，对于任意一个最简分数 $\dfrac{p}{q}$，都对应一个福特圆，圆心在 $( \dfrac{p}{q}, \dfrac{1}{2q^2} )$，半径为 $\dfrac{1}{2q^2}$，因此福特圆总是与 $x$ 轴相切。

<div>
<center>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300pt" height="165pt" viewBox="100 70 300 165" version="1.1">
<defs>
<g>
<symbol overflow="visible" id="glyph0-0">
<path style="stroke:none;" d=""/>
</symbol>
<symbol overflow="visible" id="glyph0-1">
<path style="stroke:none;" d="M 3.78125 -2.421875 C 3.78125 -3.1875 3.640625 -3.875 3.3125 -4.359375 C 3.09375 -4.671875 2.53125 -5.015625 1.984375 -5.015625 C 0.359375 -5.015625 0.171875 -2.921875 0.171875 -2.421875 C 0.171875 -1.921875 0.359375 0.140625 1.984375 0.140625 C 3.59375 0.140625 3.78125 -1.921875 3.78125 -2.421875 Z M 1.984375 -0.453125 C 1.65625 -0.453125 1.421875 -0.4375 1.28125 -1.015625 C 1.1875 -1.421875 1.1875 -2 1.1875 -2.515625 C 1.1875 -3.015625 1.1875 -3.546875 1.296875 -3.9375 C 1.4375 -4.484375 1.6875 -4.4375 1.984375 -4.4375 C 2.359375 -4.4375 2.515625 -4.390625 2.640625 -4 C 2.765625 -3.609375 2.765625 -3.109375 2.765625 -2.515625 C 2.765625 -2 2.765625 -1.484375 2.671875 -1.03125 C 2.53125 -0.40625 2.265625 -0.453125 1.984375 -0.453125 Z M 1.984375 -0.453125 "/>
</symbol>
<symbol overflow="visible" id="glyph0-2">
<path style="stroke:none;" d="M 2.515625 -4.625 C 2.515625 -4.8125 2.328125 -5.015625 2.046875 -5.015625 C 1.546875 -4.515625 1.046875 -4.578125 0.5625 -4.578125 L 0.5625 -3.9375 C 0.921875 -3.9375 1.515625 -3.984375 1.578125 -4.015625 L 1.578125 -0.765625 C 1.578125 -0.53125 1.765625 -0.640625 1.078125 -0.640625 L 0.609375 -0.640625 L 0.609375 0.015625 C 0.9375 0 1.796875 -0.03125 2.046875 -0.03125 C 2.265625 -0.03125 3.140625 0 3.484375 0.015625 L 3.484375 -0.640625 L 3.03125 -0.640625 C 2.328125 -0.640625 2.515625 -0.53125 2.515625 -0.765625 Z M 2.515625 -4.625 "/>
</symbol>
<symbol overflow="visible" id="glyph0-3">
<path style="stroke:none;" d="M 1.90625 -2.328125 C 2.453125 -2.328125 2.640625 -2.140625 2.640625 -1.40625 C 2.640625 -0.53125 2.328125 -0.46875 1.9375 -0.46875 C 1.65625 -0.46875 1.171875 -0.484375 1.09375 -0.578125 C 1.078125 -0.578125 1.34375 -1.015625 1.34375 -1.15625 C 1.34375 -1.375 0.984375 -1.734375 0.765625 -1.734375 C 0.578125 -1.734375 0.1875 -1.421875 0.1875 -1.140625 C 0.1875 -0.484375 1.09375 0.140625 1.9375 0.140625 C 2.90625 0.140625 3.765625 -0.703125 3.765625 -1.40625 C 3.765625 -1.9375 3.140625 -2.6875 2.375 -2.84375 L 2.375 -2.453125 C 3.09375 -2.71875 3.546875 -3.4375 3.546875 -3.859375 C 3.546875 -4.40625 2.734375 -5.015625 1.953125 -5.015625 C 1.1875 -5.015625 0.390625 -4.453125 0.390625 -3.890625 C 0.390625 -3.65625 0.75 -3.328125 0.953125 -3.328125 C 1.171875 -3.328125 1.5 -3.671875 1.5 -3.875 C 1.5 -4.078125 1.171875 -4.421875 1.328125 -4.40625 C 1.328125 -4.40625 1.671875 -4.421875 1.9375 -4.421875 C 2.25 -4.421875 2.5 -4.46875 2.5 -3.859375 C 2.5 -3.5625 2.453125 -3.375 2.265625 -3.15625 C 2.046875 -2.90625 1.984375 -2.953125 1.640625 -2.921875 C 1.46875 -2.90625 1.453125 -2.90625 1.421875 -2.90625 C 1.40625 -2.90625 1.15625 -2.703125 1.15625 -2.625 C 1.15625 -2.515625 1.40625 -2.328125 1.53125 -2.328125 Z M 1.90625 -2.328125 "/>
</symbol>
<symbol overflow="visible" id="glyph0-4">
<path style="stroke:none;" d="M 3.515625 -1.65625 L 3.109375 -1.65625 C 3.0625 -1.3125 3.046875 -1.03125 2.96875 -0.96875 C 2.90625 -0.921875 2.515625 -0.984375 2.40625 -0.984375 L 1.125 -0.984375 L 1.265625 -0.640625 C 2 -1.296875 2.234375 -1.484375 2.65625 -1.8125 C 3.171875 -2.234375 3.703125 -2.796875 3.703125 -3.46875 C 3.703125 -4.3125 2.78125 -5.015625 1.890625 -5.015625 C 1.03125 -5.015625 0.25 -4.21875 0.25 -3.578125 C 0.25 -3.21875 0.734375 -2.984375 0.8125 -2.984375 C 0.96875 -2.984375 1.359375 -3.296875 1.359375 -3.546875 C 1.359375 -3.671875 1.125 -4.125 1.03125 -4.125 C 1.171875 -4.421875 1.453125 -4.375 1.78125 -4.375 C 2.484375 -4.375 2.640625 -4.03125 2.640625 -3.46875 C 2.640625 -2.859375 2.265625 -2.515625 2.046875 -2.265625 L 0.375 -0.59375 C 0.296875 -0.53125 0.25 -0.390625 0.25 0 L 3.46875 0 L 3.75 -1.65625 Z M 3.515625 -1.65625 "/>
</symbol>
</g>
</defs>
<g id="surface1">
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -85.042125 -0.00046875 L 226.774281 -0.00046875 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 70.868031 70.866719 C 70.868031 110.007344 39.137563 141.733906 0.00084375 141.733906 C -39.139781 141.733906 -70.866344 110.007344 -70.866344 70.866719 C -70.866344 31.726094 -39.139781 -0.00046875 0.00084375 -0.00046875 C 39.137563 -0.00046875 70.868031 31.726094 70.868031 70.866719 Z M 70.868031 70.866719 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 212.602406 70.866719 C 212.602406 110.007344 180.871938 141.733906 141.735219 141.733906 C 102.594594 141.733906 70.868031 110.007344 70.868031 70.866719 C 70.868031 31.726094 102.594594 -0.00046875 141.735219 -0.00046875 C 180.871938 -0.00046875 212.602406 31.726094 212.602406 70.866719 Z M 212.602406 70.866719 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 88.582875 17.718281 C 88.582875 27.499531 80.653188 35.433125 70.868031 35.433125 C 61.082875 35.433125 53.149281 27.499531 53.149281 17.718281 C 53.149281 7.933125 61.082875 -0.00046875 70.868031 -0.00046875 C 80.653188 -0.00046875 88.582875 7.933125 88.582875 17.718281 Z M 88.582875 17.718281 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 55.114125 7.874531 C 55.114125 12.222187 51.586781 15.749531 47.239125 15.749531 C 42.891469 15.749531 39.364125 12.222187 39.364125 7.874531 C 39.364125 3.526875 42.891469 -0.00046875 47.239125 -0.00046875 C 51.586781 -0.00046875 55.114125 3.526875 55.114125 7.874531 Z M 55.114125 7.874531 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 102.352406 7.874531 C 102.352406 12.222187 98.828969 15.749531 94.477406 15.749531 C 90.12975 15.749531 86.606313 12.222187 86.606313 7.874531 C 86.606313 3.526875 90.12975 -0.00046875 94.477406 -0.00046875 C 98.828969 -0.00046875 102.352406 3.526875 102.352406 7.874531 Z M 102.352406 7.874531 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 39.864125 4.429219 C 39.864125 6.874531 37.87975 8.858906 35.434438 8.858906 C 32.989125 8.858906 31.00475 6.874531 31.00475 4.429219 C 31.00475 1.983906 32.989125 -0.00046875 35.434438 -0.00046875 C 37.87975 -0.00046875 39.864125 1.983906 39.864125 4.429219 Z M 39.864125 4.429219 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 110.731313 4.429219 C 110.731313 6.874531 108.746938 8.858906 106.301625 8.858906 C 103.852406 8.858906 101.871938 6.874531 101.871938 4.429219 C 101.871938 1.983906 103.852406 -0.00046875 106.301625 -0.00046875 C 108.746938 -0.00046875 110.731313 1.983906 110.731313 4.429219 Z M 110.731313 4.429219 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 31.180531 2.835469 C 31.180531 4.401875 29.911 5.671406 28.344594 5.671406 C 26.782094 5.671406 25.512563 4.401875 25.512563 2.835469 C 25.512563 1.269062 26.782094 -0.00046875 28.344594 -0.00046875 C 29.911 -0.00046875 31.180531 1.269062 31.180531 2.835469 Z M 31.180531 2.835469 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 59.528188 2.835469 C 59.528188 4.401875 58.258656 5.671406 56.69225 5.671406 C 55.125844 5.671406 53.856313 4.401875 53.856313 2.835469 C 53.856313 1.269062 55.125844 -0.00046875 56.69225 -0.00046875 C 58.258656 -0.00046875 59.528188 1.269062 59.528188 2.835469 Z M 59.528188 2.835469 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 87.875844 2.835469 C 87.875844 4.401875 86.606313 5.671406 85.039906 5.671406 C 83.4735 5.671406 82.207875 4.401875 82.207875 2.835469 C 82.207875 1.269062 83.4735 -0.00046875 85.039906 -0.00046875 C 86.606313 -0.00046875 87.875844 1.269062 87.875844 2.835469 Z M 87.875844 2.835469 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 116.2235 2.835469 C 116.2235 4.401875 114.953969 5.671406 113.387563 5.671406 C 111.821156 5.671406 110.551625 4.401875 110.551625 2.835469 C 110.551625 1.269062 111.821156 -0.00046875 113.387563 -0.00046875 C 114.953969 -0.00046875 116.2235 1.269062 116.2235 2.835469 Z M 116.2235 2.835469 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 0.00084375 70.866719 L 0.00084375 -0.00046875 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 141.735219 70.866719 L 141.735219 -0.00046875 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 70.868031 17.718281 L 70.868031 -0.00046875 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 47.239125 7.874531 L 47.239125 -0.00046875 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 94.477406 7.874531 L 94.477406 -0.00046875 " transform="matrix(1,0,0,-1,177.464,214.23)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-1" x="175.478" y="222.245"/>
</g>
<path style="fill:none;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 106.657563 -139.738781 L 110.630219 -139.738781 " transform="matrix(1,0,0,-1,68.819,83.937)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="175.478" y="229.603"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="222.717" y="222.245"/>
</g>
<path style="fill:none;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 106.66075 -139.738781 L 110.6295 -139.738781 " transform="matrix(1,0,0,-1,116.058,83.937)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="222.717" y="229.603"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-4" x="269.957" y="222.245"/>
</g>
<path style="fill:none;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 106.659031 -139.738781 L 110.631688 -139.738781 " transform="matrix(1,0,0,-1,163.298,83.937)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="269.957" y="229.603"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="246.345" y="222.245"/>
</g>
<path style="fill:none;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 106.65775 -139.738781 L 110.630406 -139.738781 " transform="matrix(1,0,0,-1,139.686,83.937)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-4" x="246.345" y="229.603"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="317.212" y="222.245"/>
</g>
<path style="fill:none;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 106.657938 -139.738781 L 110.630594 -139.738781 " transform="matrix(1,0,0,-1,210.553,83.937)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="317.212" y="229.603"/>
</g>
</g>
</svg>
</center>
</div>

福特圆有一个有趣的性质, 若两个最简分数 $\dfrac{p}{q}$ 和 $\dfrac{r}{s}$, 满足 $|ps-qr|=1$, 则它们对应的福特圆相切; 否则两个福特圆相离, 不会出现相交的情况.
下面是一个简单的证明.

<div>
<center>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="290pt" height="190pt" viewBox="90 70 290 190" version="1.1">
<defs>
<g>
<symbol overflow="visible" id="glyph10-0">
<path style="stroke:none;" d=""/>
</symbol>
<symbol overflow="visible" id="glyph10-1">
<path style="stroke:none;" d="M 3.09375 -6.546875 C 3.09375 -6.78125 2.9375 -6.96875 2.625 -6.96875 C 1.953125 -6.28125 1.203125 -6.328125 0.703125 -6.328125 L 0.703125 -5.6875 C 1.09375 -5.6875 1.796875 -5.734375 2.015625 -5.859375 L 2.015625 -0.953125 C 2.015625 -0.59375 2.15625 -0.640625 1.265625 -0.640625 L 0.765625 -0.640625 L 0.765625 0.015625 C 1.296875 -0.03125 2.15625 -0.03125 2.5625 -0.03125 C 2.953125 -0.03125 3.828125 -0.03125 4.34375 0.015625 L 4.34375 -0.640625 L 3.859375 -0.640625 C 2.953125 -0.640625 3.09375 -0.578125 3.09375 -0.953125 Z M 3.09375 -6.546875 "/>
</symbol>
<symbol overflow="visible" id="glyph10-2">
<path style="stroke:none;" d="M 1.390625 -0.8125 L 2.4375 -1.84375 C 4 -3.21875 4.640625 -3.875 4.640625 -4.859375 C 4.640625 -6 3.578125 -6.96875 2.359375 -6.96875 C 1.234375 -6.96875 0.3125 -5.875 0.3125 -5 C 0.3125 -4.4375 1 -4.28125 1.03125 -4.28125 C 1.203125 -4.28125 1.71875 -4.5625 1.71875 -4.96875 C 1.71875 -5.21875 1.359375 -5.65625 1.015625 -5.65625 C 0.9375 -5.65625 0.921875 -5.65625 1.140625 -5.734375 C 1.28125 -6.125 1.65625 -6.328125 2.234375 -6.328125 C 3.140625 -6.328125 3.390625 -5.6875 3.390625 -4.859375 C 3.390625 -4.0625 2.9375 -3.40625 2.390625 -2.78125 L 0.484375 -0.640625 C 0.375 -0.53125 0.3125 -0.40625 0.3125 0 L 4.34375 0 L 4.671875 -2.0625 L 4.078125 -2.0625 C 4 -1.59375 3.984375 -1.28125 3.875 -1.125 C 3.8125 -1.046875 3.28125 -1.09375 3.0625 -1.09375 L 1.265625 -1.09375 Z M 1.390625 -0.8125 "/>
</symbol>
<symbol overflow="visible" id="glyph10-3">
<path style="stroke:none;" d="M 6.84375 -3.265625 C 7 -3.265625 7.359375 -3.421875 7.359375 -3.625 C 7.359375 -3.8125 7 -3.984375 6.859375 -3.984375 L 0.890625 -3.984375 C 0.75 -3.984375 0.375 -3.8125 0.375 -3.625 C 0.375 -3.421875 0.75 -3.265625 0.890625 -3.265625 Z M 6.859375 -1.328125 C 7 -1.328125 7.359375 -1.484375 7.359375 -1.6875 C 7.359375 -1.890625 7 -2.046875 6.84375 -2.046875 L 0.890625 -2.046875 C 0.75 -2.046875 0.375 -1.890625 0.375 -1.6875 C 0.375 -1.484375 0.75 -1.328125 0.890625 -1.328125 Z M 6.859375 -1.328125 "/>
</symbol>
<symbol overflow="visible" id="glyph1-0">
<path style="stroke:none;" d=""/>
</symbol>
<symbol overflow="visible" id="glyph1-1">
<path style="stroke:none;" d="M 4.671875 -4.453125 C 4.671875 -4.5 4.46875 -4.71875 4.40625 -4.71875 C 4.296875 -4.71875 3.765625 -4.28125 3.75 -4.234375 C 3.671875 -4.40625 3.125 -4.734375 2.796875 -4.734375 C 1.625 -4.734375 0.21875 -3.09375 0.21875 -1.640625 C 0.21875 -0.671875 0.984375 0.109375 1.71875 0.109375 C 2.140625 0.109375 2.65625 -0.171875 3.015625 -0.53125 L 2.71875 -0.640625 C 2.625 -0.296875 2.296875 1.046875 2.265625 1.140625 C 2.1875 1.421875 2.28125 1.28125 1.71875 1.296875 C 1.59375 1.296875 1.3125 1.46875 1.3125 1.671875 C 1.3125 1.671875 1.5 1.9375 1.625 1.9375 C 1.9375 1.9375 2.296875 1.90625 2.625 1.90625 C 2.953125 1.90625 3.3125 1.9375 3.65625 1.9375 C 3.703125 1.9375 4 1.78125 4 1.578125 C 4 1.46875 3.734375 1.296875 3.5625 1.296875 C 3.09375 1.296875 3.265625 1.390625 3.265625 1.3125 C 3.265625 1.234375 3.28125 1.171875 3.296875 1.09375 Z M 1.75 -0.4375 C 1.140625 -0.4375 1.28125 -1.03125 1.28125 -1.203125 C 1.28125 -1.6875 1.5625 -2.765625 1.734375 -3.1875 C 2.046875 -3.921875 2.390625 -4.1875 2.796875 -4.1875 C 3.453125 -4.1875 3.40625 -3.53125 3.40625 -3.46875 C 3.40625 -3.40625 2.90625 -1.34375 2.875 -1.3125 C 2.734375 -1.03125 2.296875 -0.4375 1.75 -0.4375 Z M 1.75 -0.4375 "/>
</symbol>
<symbol overflow="visible" id="glyph1-2">
<path style="stroke:none;" d="M 3.890625 -4.0625 C 3.625 -4.046875 3.234375 -3.65625 3.234375 -3.4375 C 3.234375 -3.296875 3.515625 -2.984375 3.734375 -2.984375 C 3.953125 -2.984375 4.359375 -3.3125 4.359375 -3.703125 C 4.359375 -4.15625 3.765625 -4.734375 3 -4.734375 C 1.6875 -4.734375 1.140625 -3.546875 1.140625 -3.109375 C 1.140625 -2.328125 2.046875 -2.03125 2.34375 -1.96875 C 2.859375 -1.859375 3.203125 -1.90625 3.203125 -1.359375 C 3.203125 -1.109375 3.15625 -0.4375 1.953125 -0.4375 C 1.8125 -0.4375 1.21875 -0.265625 1.078125 -0.59375 C 1.203125 -0.59375 1.609375 -1.046875 1.609375 -1.328125 C 1.609375 -1.5625 1.28125 -1.84375 1.078125 -1.84375 C 0.8125 -1.84375 0.34375 -1.46875 0.34375 -1.015625 C 0.34375 -0.453125 1.09375 0.109375 1.9375 0.109375 C 3.5625 0.109375 4.109375 -1.25 4.109375 -1.703125 C 4.109375 -2.0625 3.875 -2.4375 3.765625 -2.546875 C 3.484375 -2.828125 3.078125 -2.9375 2.640625 -3.015625 C 2.28125 -3.09375 2.046875 -3 2.046875 -3.453125 C 2.046875 -3.734375 2.125 -4.1875 3 -4.1875 C 3.25 -4.1875 3.5625 -4.28125 3.65625 -4.046875 Z M 3.890625 -4.0625 "/>
</symbol>
<symbol overflow="visible" id="glyph1-3">
<path style="stroke:none;" d="M 3.5 -3.171875 C 3.5625 -3.421875 3.625 -4.1875 4.3125 -4.1875 C 4.359375 -4.1875 4.46875 -4.234375 4.6875 -4.109375 L 4.8125 -4.390625 C 4.53125 -4.34375 4.15625 -3.921875 4.15625 -3.671875 C 4.15625 -3.515625 4.453125 -3.171875 4.71875 -3.171875 C 4.9375 -3.171875 5.421875 -3.515625 5.421875 -3.90625 C 5.421875 -4.421875 4.671875 -4.734375 4.328125 -4.734375 C 3.75 -4.734375 3.265625 -4.15625 3.296875 -4.203125 C 3.203125 -4.46875 2.5 -4.734375 2.203125 -4.734375 C 1.171875 -4.734375 0.421875 -3.28125 0.421875 -3.03125 C 0.421875 -2.9375 0.703125 -2.765625 0.71875 -2.765625 C 0.796875 -2.765625 1 -2.953125 1.015625 -3.046875 C 1.359375 -4.09375 1.84375 -4.1875 2.1875 -4.1875 C 2.375 -4.1875 2.546875 -4.25 2.546875 -3.671875 C 2.546875 -3.375 2.375 -2.703125 2 -1.3125 C 1.84375 -0.6875 1.671875 -0.4375 1.234375 -0.4375 C 1.171875 -0.4375 1.0625 -0.390625 0.859375 -0.515625 L 0.734375 -0.234375 C 0.984375 -0.296875 1.375 -0.65625 1.375 -0.9375 C 1.375 -1.203125 0.984375 -1.453125 0.84375 -1.453125 C 0.53125 -1.453125 0.109375 -1.03125 0.109375 -0.703125 C 0.109375 -0.25 0.78125 0.109375 1.21875 0.109375 C 1.890625 0.109375 2.359375 -0.640625 2.390625 -0.703125 L 2.09375 -0.8125 C 2.21875 -0.4375 2.75 0.109375 3.34375 0.109375 C 4.375 0.109375 5.109375 -1.328125 5.109375 -1.578125 C 5.109375 -1.6875 4.859375 -1.859375 4.828125 -1.859375 C 4.734375 -1.859375 4.53125 -1.640625 4.515625 -1.578125 C 4.1875 -0.515625 3.6875 -0.4375 3.375 -0.4375 C 2.984375 -0.4375 2.984375 -0.59375 2.984375 -0.921875 C 2.984375 -1.140625 3.046875 -1.359375 3.15625 -1.796875 Z M 3.5 -3.171875 "/>
</symbol>
<symbol overflow="visible" id="glyph1-4">
<path style="stroke:none;" d="M 0.265625 1.0625 C 0.1875 1.390625 0.34375 1.296875 -0.09375 1.296875 C -0.203125 1.296875 -0.5 1.46875 -0.5 1.65625 C -0.5 1.734375 -0.265625 1.9375 -0.1875 1.9375 C 0.078125 1.9375 0.375 1.90625 0.640625 1.90625 C 0.984375 1.90625 1.3125 1.9375 1.640625 1.9375 C 1.6875 1.9375 1.984375 1.78125 1.984375 1.578125 C 1.984375 1.46875 1.71875 1.296875 1.578125 1.296875 C 1.078125 1.296875 1.25 1.390625 1.25 1.3125 C 1.25 1.1875 1.671875 -0.4375 1.734375 -0.6875 L 1.390625 -0.6875 C 1.515625 -0.40625 1.96875 0.109375 2.484375 0.109375 C 3.640625 0.109375 5.046875 -1.5 5.046875 -2.96875 C 5.046875 -3.90625 4.3125 -4.734375 3.5625 -4.734375 C 3.0625 -4.734375 2.453125 -4.328125 2.359375 -4.203125 C 2.328125 -4.359375 1.71875 -4.734375 1.359375 -4.734375 C 0.890625 -4.734375 0.578125 -4.296875 0.484375 -4.109375 C 0.3125 -3.78125 0.125 -3.0625 0.125 -3.03125 C 0.125 -2.9375 0.40625 -2.765625 0.421875 -2.765625 C 0.53125 -2.765625 0.703125 -2.9375 0.765625 -3.15625 C 0.9375 -3.875 0.96875 -4.1875 1.328125 -4.1875 C 1.5 -4.1875 1.453125 -4.265625 1.453125 -3.890625 C 1.453125 -3.65625 1.421875 -3.546875 1.390625 -3.375 Z M 2.375 -3.265625 C 2.4375 -3.53125 2.65625 -3.703125 2.84375 -3.859375 C 3.1875 -4.171875 3.359375 -4.1875 3.53125 -4.1875 C 3.921875 -4.1875 3.984375 -4 3.984375 -3.40625 C 3.984375 -2.828125 3.65625 -1.671875 3.484375 -1.296875 C 3.140625 -0.59375 2.84375 -0.4375 2.46875 -0.4375 C 1.8125 -0.4375 1.859375 -1.09375 1.859375 -1.15625 C 1.859375 -1.171875 1.859375 -1.203125 1.890625 -1.3125 Z M 2.375 -3.265625 "/>
</symbol>
<symbol overflow="visible" id="glyph1-5">
<path style="stroke:none;" d="M 0.703125 -0.75 C 0.671875 -0.59375 0.609375 -0.375 0.609375 -0.3125 C 0.609375 -0.140625 0.921875 0.109375 1.078125 0.109375 C 1.203125 0.109375 1.546875 -0.125 1.59375 -0.296875 C 1.578125 -0.265625 1.96875 -1.71875 2.015625 -1.90625 C 2.09375 -2.234375 2.265625 -2.9375 2.328125 -3.203125 C 2.375 -3.328125 2.609375 -3.6875 2.84375 -3.90625 C 2.921875 -3.984375 3.09375 -4.1875 3.515625 -4.1875 C 3.78125 -4.1875 3.921875 -4.0625 3.9375 -4.0625 L 3.9375 -4.390625 C 3.640625 -4.34375 3.234375 -3.9375 3.234375 -3.671875 C 3.234375 -3.515625 3.53125 -3.171875 3.796875 -3.171875 C 4.0625 -3.171875 4.515625 -3.5625 4.515625 -3.921875 C 4.515625 -4.265625 4.03125 -4.734375 3.515625 -4.734375 C 2.875 -4.734375 2.296875 -4.203125 2.109375 -3.921875 L 2.40625 -3.796875 C 2.328125 -4.25 1.796875 -4.734375 1.328125 -4.734375 C 0.875 -4.734375 0.5625 -4.296875 0.46875 -4.109375 C 0.296875 -3.78125 0.109375 -3.0625 0.109375 -3.03125 C 0.109375 -2.9375 0.390625 -2.765625 0.40625 -2.765625 C 0.515625 -2.765625 0.6875 -2.9375 0.75 -3.15625 C 0.921875 -3.875 0.953125 -4.1875 1.3125 -4.1875 C 1.46875 -4.1875 1.4375 -4.265625 1.4375 -3.890625 C 1.4375 -3.671875 1.40625 -3.5625 1.28125 -3.046875 Z M 0.703125 -0.75 "/>
</symbol>
<symbol overflow="visible" id="glyph2-0">
<path style="stroke:none;" d=""/>
</symbol>
<symbol overflow="visible" id="glyph2-1">
<path style="stroke:none;" d="M 3.515625 -1.65625 L 3.109375 -1.65625 C 3.0625 -1.3125 3.046875 -1.03125 2.96875 -0.96875 C 2.90625 -0.921875 2.515625 -0.984375 2.40625 -0.984375 L 1.125 -0.984375 L 1.265625 -0.640625 C 2 -1.296875 2.234375 -1.484375 2.65625 -1.8125 C 3.171875 -2.234375 3.703125 -2.796875 3.703125 -3.46875 C 3.703125 -4.3125 2.78125 -5.015625 1.890625 -5.015625 C 1.03125 -5.015625 0.25 -4.21875 0.25 -3.578125 C 0.25 -3.21875 0.734375 -2.984375 0.8125 -2.984375 C 0.96875 -2.984375 1.359375 -3.296875 1.359375 -3.546875 C 1.359375 -3.671875 1.125 -4.125 1.03125 -4.125 C 1.171875 -4.421875 1.453125 -4.375 1.78125 -4.375 C 2.484375 -4.375 2.640625 -4.03125 2.640625 -3.46875 C 2.640625 -2.859375 2.265625 -2.515625 2.046875 -2.265625 L 0.375 -0.59375 C 0.296875 -0.53125 0.25 -0.390625 0.25 0 L 3.46875 0 L 3.75 -1.65625 Z M 3.515625 -1.65625 "/>
</symbol>
<symbol overflow="visible" id="glyph2-2">
<path style="stroke:none;" d="M 2.515625 -4.625 C 2.515625 -4.8125 2.328125 -5.015625 2.046875 -5.015625 C 1.546875 -4.515625 1.046875 -4.578125 0.5625 -4.578125 L 0.5625 -3.9375 C 0.921875 -3.9375 1.515625 -3.984375 1.578125 -4.015625 L 1.578125 -0.765625 C 1.578125 -0.53125 1.765625 -0.640625 1.078125 -0.640625 L 0.609375 -0.640625 L 0.609375 0.015625 C 0.9375 0 1.796875 -0.03125 2.046875 -0.03125 C 2.265625 -0.03125 3.140625 0 3.484375 0.015625 L 3.484375 -0.640625 L 3.03125 -0.640625 C 2.328125 -0.640625 2.515625 -0.53125 2.515625 -0.765625 Z M 2.515625 -4.625 "/>
</symbol>
<symbol overflow="visible" id="glyph3-0">
<path style="stroke:none;" d=""/>
</symbol>
<symbol overflow="visible" id="glyph3-1">
<path style="stroke:none;" d="M 6.5625 -2.296875 C 6.734375 -2.296875 7.125 -2.421875 7.125 -2.625 C 7.125 -2.828125 6.734375 -2.953125 6.5625 -2.953125 L 1.171875 -2.953125 C 1 -2.953125 0.625 -2.828125 0.625 -2.625 C 0.625 -2.421875 1 -2.296875 1.171875 -2.296875 Z M 6.5625 -2.296875 "/>
</symbol>
</g>
</defs>
<g id="surface1">
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 283.462781 0.0015 L 566.927625 0.0015 " transform="matrix(1,0,0,-1,-191.037,229.939)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 550.88075 78.700719 C 550.88075 122.189 515.626844 157.442906 472.134656 157.442906 C 428.646375 157.442906 393.392469 122.189 393.392469 78.700719 C 393.392469 35.212437 428.646375 -0.0414688 472.134656 -0.0414688 C 515.626844 -0.0414688 550.88075 35.212437 550.88075 78.700719 Z M 550.88075 78.700719 " transform="matrix(1,0,0,-1,-191.037,229.939)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 398.431531 44.267125 C 398.431531 68.728062 378.5995 88.560094 354.138562 88.560094 C 329.677625 88.560094 309.845594 68.728062 309.845594 44.267125 C 309.845594 19.806187 329.677625 -0.0258438 354.138562 -0.0258438 C 378.5995 -0.0258438 398.431531 19.806187 398.431531 44.267125 Z M 398.431531 44.267125 " transform="matrix(1,0,0,-1,-191.037,229.939)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 472.134656 78.700719 L 472.134656 44.267125 " transform="matrix(1,0,0,-1,-191.037,229.939)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph10-1" x="290.751" y="163.91"/>
</g>
<path style="fill:none;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -261.841719 -155.449156 L -247.587812 -155.449156 " transform="matrix(1,0,0,-1,547.955,12.711)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph10-2" x="286.114" y="177.484"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-1" x="291.095" y="177.484"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph2-1" x="295.9" y="174.606"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph3-1" x="303.779" y="170.65"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph10-1" x="319.507" y="163.91"/>
</g>
<path style="fill:none;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -233.0175 -155.449156 L -218.896406 -155.449156 " transform="matrix(1,0,0,-1,547.955,12.711)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph10-2" x="314.937" y="177.484"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-2" x="319.918" y="177.484"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph2-1" x="324.588" y="174.606"/>
</g>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 472.134656 44.267125 L 472.396375 0.0015 " transform="matrix(1,0,0,-1,-191.037,229.939)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 354.138562 44.267125 L 354.333875 0.0015 " transform="matrix(1,0,0,-1,-191.037,229.939)"/>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 354.138562 44.267125 L 396.634656 56.653844 " transform="matrix(1,0,0,-1,-191.037,229.939)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph10-1" x="169.785" y="162.087"/>
</g>
<path style="fill:none;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -261.841156 -155.447937 L -247.720062 -155.447937 " transform="matrix(1,0,0,-1,427.056,10.888)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph10-2" x="165.215" y="175.661"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-2" x="170.196" y="175.661"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph2-1" x="174.866" y="172.783"/>
</g>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 396.634656 56.653844 L 472.134656 78.700719 " transform="matrix(1,0,0,-1,-191.037,229.939)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph10-1" x="228.716" y="142.933"/>
</g>
<path style="fill:none;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -261.841875 -155.449594 L -247.584062 -155.449594 " transform="matrix(1,0,0,-1,485.92,-8.266)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph10-2" x="224.079" y="156.507"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-1" x="229.06" y="156.507"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph2-1" x="233.865" y="153.629"/>
</g>
<path style="fill:none;stroke-width:0.99628;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-dasharray:2.98883,2.98883;stroke-miterlimit:10;" d="M 354.138562 44.267125 L 472.134656 44.267125 " transform="matrix(1,0,0,-1,-191.037,229.939)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-3" x="265.934" y="244.488"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph2-2" x="271.628" y="245.983"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph10-3" x="278.865" y="244.488"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-4" x="290.577" y="237.748"/>
</g>
<path style="fill:none;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -238.392875 -155.447094 L -233.381156 -155.447094 " transform="matrix(1,0,0,-1,528.971,86.549)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-1" x="290.68" y="251.322"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-3" x="147.993" y="244.488"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph2-1" x="153.687" y="245.983"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph10-3" x="160.924" y="244.488"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-5" x="172.636" y="237.748"/>
</g>
<path style="fill:none;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -238.393281 -155.447094 L -233.62375 -155.447094 " transform="matrix(1,0,0,-1,411.03,86.549)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-2" x="172.686" y="251.322"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-4" x="207.807" y="210.908"/>
</g>
<path style="fill:none;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -261.839406 -155.44725 L -256.827688 -155.44725 " transform="matrix(1,0,0,-1,469.648,59.709)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-1" x="207.911" y="224.482"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph3-1" x="216.229" y="217.648"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-5" x="227.387" y="210.908"/>
</g>
<path style="fill:none;stroke-width:0.3985;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M -242.261281 -155.44725 L -237.49175 -155.44725 " transform="matrix(1,0,0,-1,469.648,59.709)"/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-2" x="227.438" y="224.482"/>
</g>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 473.13075 78.700719 C 473.13075 79.2515 472.685437 79.696812 472.134656 79.696812 C 471.587781 79.696812 471.138562 79.2515 471.138562 78.700719 C 471.138562 78.149937 471.587781 77.704625 472.134656 77.704625 C 472.685437 77.704625 473.13075 78.149937 473.13075 78.700719 Z M 473.13075 78.700719 " transform="matrix(1,0,0,-1,-191.037,229.939)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 355.134656 44.267125 C 355.134656 44.817906 354.689344 45.263219 354.138562 45.263219 C 353.587781 45.263219 353.142469 44.817906 353.142469 44.267125 C 353.142469 43.716344 353.587781 43.271031 354.138562 43.271031 C 354.689344 43.271031 355.134656 43.716344 355.134656 44.267125 Z M 355.134656 44.267125 " transform="matrix(1,0,0,-1,-191.037,229.939)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 397.63075 56.653844 C 397.63075 57.204625 397.185437 57.649937 396.634656 57.649937 C 396.083875 57.649937 395.638562 57.204625 395.638562 56.653844 C 395.638562 56.103062 396.083875 55.65775 396.634656 55.65775 C 397.185437 55.65775 397.63075 56.103062 397.63075 56.653844 Z M 397.63075 56.653844 " transform="matrix(1,0,0,-1,-191.037,229.939)"/>
<path style="fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;stroke-width:0.79701;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 473.13075 44.267125 C 473.13075 44.817906 472.685437 45.263219 472.134656 45.263219 C 471.587781 45.263219 471.138562 44.817906 471.138562 44.267125 C 471.138562 43.716344 471.587781 43.271031 472.134656 43.271031 C 472.685437 43.271031 473.13075 43.716344 473.13075 44.267125 Z M 473.13075 44.267125 " transform="matrix(1,0,0,-1,-191.037,229.939)"/>
</g>
</svg>

</center>
</div>

若两个福特圆相切, 需要满足下面的关系:
$$
\begin{aligned}
\left(\frac{p}{q} - \frac{r}{s}\right)^2 + \left( \frac{1}{2q^2} - \frac{1}{2s^2} \right)^2 &= \left( \frac{1}{2q^2} + \frac{1}{2s^2} \right)^2 \\\ 
\frac{(ps-qr)^2}{q^2s^2} &= 4\cdot \frac{1}{2q^2}\cdot\frac{1}{2s^2}\\\ 
(ps-qr)^2 &= 1
\end{aligned}
$$
即 $|ps-qr| = 1$. 
该过程反向也是成立的,  即只要 $|ps-qr| = 1$, 则对应的两个福特圆就相切. 
而如果 $|ps-qr| > 1$, 将得到
$$ \left(\frac{p}{q} - \frac{r}{s}\right)^2 + \left( \frac{1}{2q^2} - \frac{1}{2s^2} \right)^2 > \left( \frac{1}{2q^2} + \frac{1}{2s^2} \right)^2 ,$$
也就是两个福特圆相离. $|ps-qr| < 1$, 因为 $p,q,r,s$ 都是整数, 所以只能是 $|ps-qr| = 0$, 或写成 $\dfrac{p}{q} = \dfrac{r}{s}$. 但 $\dfrac{p}{q}$ 和 $\dfrac{r}{s}$ 都是最简分数, 则只能是 $p=r, q=s$, 也就是两圆重合.

## 法里和

福特圆还有另一个有趣的性质. 如果两个最简分数$\dfrac{p}{q},\dfrac{r}{s}$ 对应的福特圆相切, 则在这两圆之间还存在一个福特圆与它们分别相切, 其对应的最简分数为 $\dfrac{p+r}{q+s}$. 

不失一般性, 可以假设 $\dfrac{p}{q} < \dfrac{r}{s}$, 根据两圆相切的条件, 可知 $qr - ps = 1$. 并且容易证明 $\dfrac{p}{q} < \dfrac{p+r}{q+s} < \dfrac{r}{s}$, 事实上, 
$$\frac{p+r}{q+s} - \frac{p}{q} = \frac{pq+rq-pq-ps}{(q+s)q} = \frac{1}{(q+s)q} > 0 .$$
类似的有 $\dfrac{p+r}{q+s} - \dfrac{r}{s} < 0$. 所以 $\dfrac{p+r}{q+s}$ 位于 $\dfrac{p}{q}$ 和 $\dfrac{r}{s}$ 之间.

然后证明 $\dfrac{p+r}{q+s}$ 是最简分数. 从上面的计算过程可知
$$ q(p+r) - p(q+s) = 1 . $$
$p+r$与$q+s$的整数倍线性组合能得到$1$, 由裴蜀定理可得$p+r$与$q+s$互素.

再证明 $\dfrac{p+r}{q+s}$ 对应的福特圆与$\dfrac{p}{q},\dfrac{r}{s}$ 对应的福特圆分别相切. 根据相切条件, 只要满足:
$$ |(p+r)q - (q+s)p| = 1 ,$$
以及
$$ |(p+r)s - (q+s)r| = 1  .$$
而这两个条件在 $qr - ps = 1$ 时都是成立的.

像这样将两个最简分数的分子和分母分别相加的操作称为法里和, 或法里加法, 英文文献中记为 mediant 或 Farey Addition.

## 可视化

笔者做了一个可视化演示，每个圆在中心标注了圆半径，可以按住画面拖动，也可以点 ZoomIn/ZoomOut 按钮缩放画面。

<div>
<canvas id="canvas" style="border:1px solid #d3d3d3;"> </canvas>
</div>

<div>
<center>
<input value="zoom in" type="button" onclick="zoom_in()" />
<input value="zoom out" type="button" onclick="zoom_out()" />
</center>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

// states
var mouse_state = 0;    // 0: not pressed, 1: pressed
var mouse_x = 0;
var mouse_y = 0;

var press_x = 0;
var press_y = 0;
var old_plot_center_x = 0;
var old_plot_center_y = 0;

function init() {
    canvas.width = window.innerWidth*0.5;
    canvas.height = window.innerHeight*0.7;
}

function IsMousePressed() {
    return mouse_state == 1;
}


init();

var offset_x = canvas.width*0.5;
var offset_y = canvas.height*0.5;
var scale = Math.min(canvas.width, canvas.height)*0.5;

var plot_range = 0.5;
var plot_center_x = 0.25;
var plot_center_y = 0.25;

function plot_size_to_canvas_size() {
    return scale / plot_range;
}

function canvas_size_to_plot_size() {
    return plot_range / scale;
}

function plot_pos_to_canvas_pos(x,y) {
    return {x: (x - plot_center_x) / plot_range *scale + offset_x, y: ((y - plot_center_y) / plot_range * scale + offset_y)}
}


function gcd(m,n) {
    if (n % m == 0) return m;
    else return gcd( n % m, m);
}

function draw_circle(x,y,r) {
    var center_in_canvas = plot_pos_to_canvas_pos(x,y);
    var radius_in_canvas = r * plot_size_to_canvas_size();
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.arc(center_in_canvas.x, canvas.height - center_in_canvas.y, radius_in_canvas, 0, 2 * Math.PI);
    ctx.stroke();
}

function draw_text(text, canvas_x, canvas_y) {
    ctx.fillText(text, canvas_x, canvas_y);
}

function get_text_dims(text) {
    var metrics = ctx.measureText(text);
    return {width: metrics.width, height: metrics.actualBoundingBoxAscent - metrics.actualBoundingBoxDescent };
}

function draw_fraction_text(numerator_text, denominator_text, text_center_x, text_center_y, font_size, font_name, max_size_plot) {
    if (font_size < 10) return;

    ctx.font = '' + font_size + 'px ' + font_name;

    var max_size_canvas = max_size_plot * plot_size_to_canvas_size();
    var denominator_dims = get_text_dims(denominator_text);
    var numerator_dims = get_text_dims(numerator_text);
    var seperator_height = font_size*0.2; 
    var box_width = Math.max(denominator_dims.width, numerator_dims.width);
    var box_height = denominator_dims.height + numerator_dims.height + seperator_height;
    if (Math.max(box_height, box_width) > max_size_canvas) return;

    var center_pos = plot_pos_to_canvas_pos(text_center_x, text_center_y);
    draw_text(numerator_text, center_pos.x, canvas.height - (center_pos.y + seperator_height/2 + font_size/2));
    draw_text(denominator_text, center_pos.x, canvas.height - (center_pos.y - seperator_height/2 - font_size/2));

    var seperator_text = '─'.repeat(Math.max(denominator_text.length, numerator_text.length));
    draw_text(seperator_text, center_pos.x, canvas.height - (center_pos.y));    
    /*ctx.beginPath();
    ctx.moveTo(center_pos.x - box_width / 2, canvas.height - center_pos.y);
    ctx.lineTo(center_pos.x + box_width / 2, canvas.height - center_pos.y);
    ctx.stroke();*/
}

function draw() {
    var draw_count = 0;
    var iterate_count = 0;
    draw_circle(0, 0.5, 0.5);
    draw_circle(1, 0.5, 0.5);
    for (var n = 2; n < 100000; n++) {
        var r = 0.5 / (n*n);
        var radius_in_canvas = r * plot_size_to_canvas_size();
        if (radius_in_canvas < 1) break;
        // var font_size = Math.round(canvas.height * r / 16) / plot_range;
        var font_size = 25;
        var left = Math.max(1, Math.floor( (plot_center_x - plot_range - r) * n));
        var right = Math.min(n, Math.ceil((plot_center_x + plot_range + r) * n ));
        for (var m = left; m <= right; m++) {
            iterate_count ++;
            if (gcd(n,m) != 1) continue;
            var x = (1.0*m) / n;
            draw_count++;
            draw_circle(x, r, r); 
            draw_fraction_text('' + m, ''+ n, x, r, font_size, 'consolas', r);
        }
    }
    // console.log(draw_count, iterate_count);
    // x-axis
    var line_start = plot_pos_to_canvas_pos(-1000,0);
    var line_end = plot_pos_to_canvas_pos(1000,0);
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(line_start.x, canvas.height - line_start.y);
    ctx.lineTo(line_end.x, canvas.height - line_end.y);
    ctx.stroke();
}

function zoom_in() {
    plot_range /= 1.414;
}

function zoom_out() {
    plot_range *= 1.414;
}

function render() {
    ctx.clearRect(0,0,canvas.width, canvas.height);
    ctx.lineWidth = 2;
    ctx.font = "20px consolas";
    ctx.textAlign = 'center';
    ctx.textBase = 'middle';
    ctx.setTransform(1, 0, 0, 1, 0, 0);
    // ctx.translate(0.5, 0.5);
    draw();
    window.requestAnimationFrame(render);
}
window.requestAnimationFrame(render);

function move_plot() {
    if (mouse_state == 1) {
        var dx = mouse_x - press_x;
        var dy = mouse_y - press_y;
        plot_center_x = old_plot_center_x - dx * plot_range / scale;
        plot_center_y = old_plot_center_y + dy * plot_range / scale;
    }
}

canvas.addEventListener('mousedown', function (event) {
    mouse_state = 1;
    mouse_x = event.clientX;
    mouse_y = event.clientY;
    press_x = mouse_x;
    press_y = mouse_y;
    old_plot_center_x = plot_center_x;
    old_plot_center_y = plot_center_y;
}, false);
canvas.addEventListener('mousemove', function (event) {
    mouse_x = event.clientX;
    mouse_y = event.clientY;
    move_plot();
}, false);
canvas.addEventListener('mouseup', function (event) {
    mouse_state = 0;
    mouse_x = event.clientX;
    mouse_y = event.clientY;
}, false);
function getTouchPos(canvasDom, touchEvent) {
  var rect = canvasDom.getBoundingClientRect();
  return {
    x: touchEvent.touches[0].clientX - rect.left,
    y: touchEvent.touches[0].clientY - rect.top
  };
}
canvas.addEventListener("touchstart", function (e) {
    mousePos = getTouchPos(canvas, e);
    var touch = e.touches[0];
    var mouseEvent = new MouseEvent("mousedown", {
        clientX: touch.clientX,
        clientY: touch.clientY
    });
  canvas.dispatchEvent(mouseEvent);
  event.preventDefault();
}, false);
canvas.addEventListener("touchend", function (e) {
    var mouseEvent = new MouseEvent("mouseup", {});
    canvas.dispatchEvent(mouseEvent);
    event.preventDefault();
}, false);
canvas.addEventListener("touchmove", function (e) {
    var touch = e.touches[0];
    var mouseEvent = new MouseEvent("mousemove", {
        clientX: touch.clientX,
        clientY: touch.clientY
    });
    canvas.dispatchEvent(mouseEvent);
    event.preventDefault();
}, false);

</script>

</div>
